(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"0Zna":function(e,t,n){},"7TnZ":function(e,t,n){},A5vn:function(e,t,n){},Eh1p:function(e,t,n){},IygI:function(e,t,n){},J2fM:function(e,t,n){},QZRf:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var a={"/userCenter":{title:{titleIcon:"user",titleText:"用户中心"},tabs:[{tabText:"基本资料",tabPath:"/userCenter/info"},{tabText:"安全设置",tabPath:"/userCenter/security"},{tabText:"访问用户",tabPath:["/userCenter/visit","/userCenter/look"]},{tabText:"用户角色",tabPath:["/userCenter/role","/userCenter/add"]},{tabText:"操作日志",tabPath:"/userCenter/log"},{tabText:"实例管理",tabPath:["/userCenter/case"]},{tabText:"授权管理",tabPath:["/userCenter/authorize"]},{tabText:"数据资产",tabPath:["/userCenter/dataasset","userCenter/assetdetail"]}]},"/messageCenter":{title:{titleIcon:"sound",titleText:"消息中心"},notRoute:!0,tabs:[{tabText:"全部消息"},{tabText:"未读消息"},{tabText:"已读消息"}]}}},a5gO:function(e,t,n){},bc1A:function(e,t,n){"use strict";n.r(t);n("pNMO"),n("4Brf"),n("0oug"),n("4mDm"),n("zKZe"),n("NBAS"),n("ExoC"),n("07d7"),n("PKPk"),n("Rm1S"),n("3bBZ");var a=n("E+oP"),r=n.n(a),o=n("q1tI"),i=n.n(o),c=n("Ty5D"),s=n("/MKj"),l=n("Nlzp"),u=n("vS40"),p=n("MeRu"),d=n("cu44"),f=(n("TeQF"),n("2B1R"),n("5DmW"),n("27RR"),n("tkto"),n("FZtP"),n("L/Qf"),n("2/Rp")),m=(n("tULf"),n("Vl3Y")),h=(n("1vPl"),n("5rEg")),y=(n("O+I2"),n("TeRw")),b=(n("8QGh"),n("2fM7"));function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(n,!0).forEach(function(t){k(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function w(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I,x=b.a.Option,C={labelCol:{span:4},wrapperCol:{span:20}},L=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=w(this,j(t).call(this,e))).getCityList=function(e){Object(l.c)(l.a.getCityByProvinceId,{provinceId:e}).then(function(t){n.setState(function(n){return{cityListObj:Object.assign({},n.cityListObj,k({},e,t.data))}})})},n.handleSubmit=function(e){e.preventDefault();var t=n.state,a=t.province,r=t.city;n.props.form.validateFields(function(e,t){if(!e){var o=O({},t,{province:a,city:r,countryId:0});Object(l.d)(l.a.upDeveloperInfo,O({},o),{loading:!0}).then(function(e){y.a.success({message:"更新成功",description:"用户信息更新成功！"}),n.props.getDeveloperInfo()})}})},n.getOptions=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"province",t=(arguments.length>1&&arguments[1],n.state),a=t.provinceList,r=t.province,o=t.cityListObj,c=i.a.createElement(x,{key:-999,value:""},"请选择"),s=[],l=o[r]||[];return(s="province"===e?a.map(function(e){var t=e.provinceId,n=e.provinceName;return-1===t?null:i.a.createElement(x,{key:t,value:t},n)}):l.map(function(e){var t=e.cityId,n=e.cityName;return i.a.createElement(x,{key:t,value:""+t},n)})).unshift(c),s},n.changeHandle=function(e,t){if("province"===e){var a=t;a&&n.getCityList(a),n.setState({city:""})}n.setState(k({},e,t))};var a=n.props.developerInfo,r=void 0===a?{}:a,o=r.province,c=r.city;return n.state={provinceList:[],cityListObj:{},province:o||"",city:c||""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this.getProvinceList()}},{key:"componentDidUpdate",value:function(e,t){var n=this,a=JSON.stringify(e.developerInfo),r=JSON.stringify(this.props.developerInfo);if("{}"===a&&a!==r){var o=this.props.developerInfo,i=o.province,c=o.city;this.setState({province:i||"",city:c||""},function(){n.getProvinceList()})}}},{key:"getProvinceList",value:function(){var e=this,t=this.state,n=t.province;0===t.provinceList.length&&Object(l.c)(l.a.getProvince).then(function(t){e.setState({provinceList:t.data})}),n&&this.getCityList(n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.form,a=t.loading,r=t.developerInfo,o=this.state,c=o.province,s=o.city,l=r.mobilePhone,u=r.contactPerson,p=r.contactAddr,d=n.getFieldDecorator;return-1==+c&&(c=""),i.a.createElement(m.a,v({},C,{onSubmit:this.handleSubmit}),i.a.createElement(m.a.Item,{label:"国家"},i.a.createElement(h.a,{value:"中国",disabled:!0,placeholder:"请选择国家"})),i.a.createElement(m.a.Item,{label:"所在地区",style:{marginBottom:0}},i.a.createElement(m.a.Item,{style:{display:"inline-block",width:"30%"}},i.a.createElement(b.a,{style:{width:"90%"},value:c,onChange:function(t){return e.changeHandle("province",t)}},this.getOptions("province"))),i.a.createElement(m.a.Item,{style:{display:"inline-block",width:"30%"}},i.a.createElement(b.a,{style:{width:"90%"},value:s,onChange:function(t){return e.changeHandle("city",t)}},this.getOptions("city",s)))),i.a.createElement(m.a.Item,{label:"联系地址"},d("contactAddr",{rules:[{max:100,message:"最大输入长度为100"}],initialValue:p})(i.a.createElement(h.a,{placeholder:"请输入联系地址"}))),i.a.createElement(m.a.Item,{label:"联系人"},d("contactPerson",{rules:[{pattern:/^[a-zA-Z0-9\u4e00-\u9fa5]{2,20}$/,message:"请输入2到20长度的汉字、字母和数字"}],initialValue:u})(i.a.createElement(h.a,{placeholder:"请输入联系人"}))),i.a.createElement(m.a.Item,{label:"联系电话"},d("mobilePhone",{rules:[{pattern:/^(((\d{3,4}-)?\d{7,8})|(1\d{10}))$/,message:"请输入固话号码或者手机号码"}],initialValue:l})(i.a.createElement(h.a,{placeholder:"请输入联系电话"}))),i.a.createElement(m.a.Item,{wrapperCol:{span:24}},i.a.createElement("div",{className:"ant-col ant-col-4 ant-form-item-label"}),i.a.createElement("div",null,i.a.createElement(f.a,{type:"primary",htmlType:"submit",loading:a},"保存"))))}}])&&S(n.prototype,a),r&&S(n,r),t}(),N=m.a.create({name:"contact-information"})(L),R=n("NJiU"),P=(n("IygI"),n("DgvE"));function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function A(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function V(e,t,n){return t&&A(e.prototype,t),n&&A(e,n),e}function M(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var q,W=Object(s.b)(function(e){return{developerInfo:e.getIn(["userCenter","developerInfo"]).toJS()}},function(e){return{getDeveloperInfo:function(){return e(Object(u.d)())}}})(I=function(e){function t(){return F(this,t),M(this,K(t).apply(this,arguments))}return U(t,o["Component"]),V(t,[{key:"render",value:function(){var e=this.props,t=e.developerInfo,n=e.match,a=e.getDeveloperInfo,r=n.path;return i.a.createElement(c.e,null,i.a.createElement(c.c,{path:"".concat(r,"/base"),render:function(e){return i.a.createElement(G,D({},e,{developerInfo:t,getDeveloperInfo:a}))}}),i.a.createElement(c.b,{to:"".concat(r,"/base")}))}}]),t}())||I,G=function(e){function t(e){var n;F(this,t),(n=M(this,K(t).call(this,e))).getSubRights=function(){var e=n.props.developerInfo;(void 0===e?{}:e).isSubUser&&Object(l.c)(l.a.getRightsOneself,{},{loading:!0}).then(function(e){for(var t=[],a=[],r=[],o=e.data,i=0;i<o.length;i++){var c=o[i];"productService"==c.menuCode&&(t=c.checkBoxGroupList),"dataObject"==c.menuCode&&(a=c.checkBoxGroupList),"dataDimension"==c.menuCode&&(r=c.checkBoxGroupList)}n.setState({productResource:t,dataObjRightsList:a,dataDimensionRightsList:r})})};var a=n.props.developerInfo.isSubUser;return n.state={isSubUser:!!a,productResource:[],dataObjRightsList:[],dataDimensionRightsList:[]},n}return U(t,o["Component"]),V(t,[{key:"componentDidMount",value:function(){this.getSubRights()}},{key:"componentDidUpdate",value:function(e){var t=this.props.developerInfo.isSubUser;e.developerInfo.isSubUser!==t&&(this.getSubRights(),this.setState({isSubUser:!!t}))}},{key:"render",value:function(){var e=this.state,t=e.isSubUser,n=e.productResource,a=e.dataObjRightsList,r=e.dataDimensionRightsList,o=this.props,c=o.developerInfo,s=o.getDeveloperInfo,l=c.id,u=c.email,f=c.createTime,m=c.userRole,h=c.parentAccount,y=c.account;return t?i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{noback:!0,title:"基本资料"}),i.a.createElement(d.a,{title:"基本信息"},i.a.createElement("div",{className:"alone-section-content-default base-info"},i.a.createElement("div",{className:"p-flex"},i.a.createElement("span",{className:"flex-item"},i.a.createElement("span",{className:"title"},"登录账号："),y),i.a.createElement("span",{className:"flex-item"},i.a.createElement("span",{className:"title"},"所属主帐号："),h),i.a.createElement("span",{className:"flex-item"},i.a.createElement("span",{className:"title"},"账户角色："),m),i.a.createElement("span",{className:"flex-item"},i.a.createElement("span",{className:"title"},"创建时间："),f?P.a.utcToDev(f):"")))),i.a.createElement(R.a,{userCategory:"1",productResource:n,dataObjRightsList:a,dataDimensionRightsList:r})):i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{noback:!0,title:"基本资料"}),i.a.createElement(d.a,{title:"基本信息"},i.a.createElement("div",{className:"alone-section-content-default base-info"},i.a.createElement("div",{className:"p-flex"},i.a.createElement("span",{className:"flex-item"},i.a.createElement("span",{className:"title"},"开发者ID："),l),i.a.createElement("span",{className:"flex-item"},i.a.createElement("span",{className:"title"},"电子邮箱："),u),i.a.createElement("span",{className:"flex-item"},i.a.createElement("span",{className:"title"},"注册时间："),f?P.a.utcToDev(f):"")))),i.a.createElement(d.a,{title:"联系信息"},i.a.createElement("div",{className:"alone-section-content-default form-wrapper"},i.a.createElement(N,{getDeveloperInfo:s,developerInfo:c}))))}}]),t}(),J=(n("ma9I"),n("SYor"),n("EpIQ"),n("bx4M")),H=(n("mbEz"),n("wCAj")),z=(n("k994"),n("NJEC")),Z=(n("qNb/"),n("PArb")),Y=(n("0lcf"),n("mr32")),Q=n("wd/R"),$=n.n(Q),X=(n("sCcn"),n("P2RN"));function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oe=Object(s.b)(function(e){return{}},function(e){return{deleteRole:function(t){return e(Object(u.b)(t))}}})(q=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=ne(t).call(this,e),(n=!r||"object"!==ee(r)&&"function"!=typeof r?ae(a):r).getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(l.c)(l.a.getRolePage,e).then(function(e){n.setState({roleList:e.data.list,pager:e.data.pager,loading:!1})})},n.deleteRole=function(e){var t=n.state.pager,a=t.totalRows,r=t.pageIndex;r=a%(10*(r-1))>1?r:r-1,n.props.deleteRole(e).then(function(e){e&&(Object(X.a)({type:"success",description:"删除用户角色成功！"}),n.setState({loading:!0}),n.getList({pageIndex:r,pageRows:10}))})},n.searchProduct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e=e.trim(),n.setState({loading:!0},function(){n.getList({pageIndex:1,pageRows:10,roleName:e})})},n.editRole=function(e,t,n,a){t=encodeURI(t),n=encodeURI(n),window.location.hash="#/userCenter/add?roleId=".concat(e,"&roleName=").concat(t,"&remark=").concat(n,"&userCategory=").concat(a)},n.state={versionList:[],loading:!0,roleList:[],pager:{}},n.columns=[{title:"角色名",dataIndex:"roleName",key:"roleName"},{title:"备注",dataIndex:"remark",key:"remark"},{title:"访问方式",key:"userCategory",dataIndex:"userCategory",render:function(e){return i.a.createElement("span",null,i.a.createElement(Y.a,{color:1==e?"blue":"green"},1==e?"控制台访问用户":"接口访问用户"))}},{title:"最新修改时间",dataIndex:"modifyTime",key:"modifyTime",render:function(e){return i.a.createElement("span",null,P.a.utcToDev(e))}},{title:"操作",key:"tags",dataIndex:"tags",render:function(e,t){return i.a.createElement("span",null,i.a.createElement("a",{onClick:n.editRole.bind(ae(n),t.roleId,t.roleName,t.remark,t.userCategory)},"编辑"),i.a.createElement(Z.a,{type:"vertical"}),i.a.createElement(z.a,{title:"你确定要删除该角色吗？",onConfirm:n.deleteRole.bind(ae(n),t.roleId),okText:"是",cancelText:"否",placement:"topRight"},i.a.createElement("a",null,"删除")))}}],n.pagerIndex=n.pagerIndex.bind(ae(n)),n.addRole=n.addRole.bind(ae(n)),n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this.getList({pageIndex:1,pageRows:10})}},{key:"addRole",value:function(){this.props.history.push({pathname:"/userCenter/add"})}},{key:"pagerIndex",value:function(e){var t=this;this.setState({loading:!0},function(){t.getList({pageIndex:e,pageRows:10})})}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.roleList,r=t.pager;return i.a.createElement("div",{className:"role-management"},i.a.createElement("header",{className:"page-content-header"},i.a.createElement("h3",{className:"page-name"},"用户角色"),i.a.createElement("div",null,i.a.createElement("div",{className:"searchBox"},i.a.createElement(h.a.Search,{placeholder:"请输入用户角色名查找",maxLength:20,onSearch:function(t){return e.searchProduct(t)},enterButton:!0})),i.a.createElement("div",{className:"butFloatRight"},i.a.createElement(f.a,{type:"primary",onClick:this.addRole},"创建用户角色")))),i.a.createElement(J.a,null,i.a.createElement(H.a,{rowKey:"roleId",columns:this.columns,dataSource:a,pagination:{defaultCurrent:r.pageIndex,total:r.totalRows,current:r.pageIndex,hideOnSinglePage:!1,onChange:this.pagerIndex},loading:n})))}}])&&te(n.prototype,a),r&&te(n,r),t}())||q,ie=(n("pjDv"),n("yXV3"),n("pDQq"),n("JfAA"),n("YGK4"),n("EnZy"),n("49+q"),n("AVoK"),n("hcok"),n("dNT4"),n("3uUd"),n("tijO"),n("ZY7T"),n("C1JJ"),n("lmH4"),n("Co1j"),n("5JV0"),n("ctDJ"),n("JwUS"),n("qaHo"),n("Si40"),n("BGb9"),n("K4yd"),n("9yH6")),ce=(n("dlhN"),n("MJZm")),se=n("wig9"),le=n.n(se),ue=n("BkRI"),pe=n.n(ue),de=n("v7xx"),fe=n("8QW8");n("A5vn");function me(e){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(){return(he=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ye(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ge(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ve(e,t,n){return t&&ge(e.prototype,t),n&&ge(e,n),e}function Ee(e,t){return!t||"object"!==me(t)&&"function"!=typeof t?Oe(e):t}function Oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Se(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&we(e,t)}function we(e,t){return(we=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var je=b.a.Option,_e=[{id:"1",text:"产品服务权限"},{id:"2",text:"数据对象权限"},{id:"3",text:"数据维度权限"},{id:"5",text:"项目权限"}],Ie=[{id:"2",text:"数据对象权限"},{id:"3",text:"数据维度权限"},{id:"4",text:"API调用权限"}],xe=[],Ce=[],Le=[],Ne=function(e){function t(e){var n;return be(this,t),(n=Ee(this,ke(t).call(this,e))).onExpand=function(e){1==n.props.terrType?n.props.onExpand(e,!1):n.setState({expandedKey:e})},n.triExpand=function(e){n.setState({expandedKey:ye(e)})},n.onCheck=function(e,t){n.setState({checkedKeys:e},function(){n.props.shuttle(e,t)})},n.onSelect=function(e,t){n.setState({selectedKeys:e})},n.checkShow=function(e,t){var n=!1;return e.map(function(e){0===e.indexOf(t)&&(n=!0)}),n},n.selectList=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return e.map(function(e,o){return e.tree_show=!!(n.checkShow(t,e.key)||e.title&&e.title.indexOf(a)>-1),r&&e.tree_show&&(r.tree_show=e.tree_show),e.children&&(e.children=n.selectList(e.children,t,a,e)),e})},n.renderTreeNodes=function(e){var t=n.props,a=t.searchValue,r=(t.expandedKeys,t.seek_tree_show),o=t.expandedKeys_seek,c=t.terrType,s=pe()(e);return r&&1===c&&(s=n.selectList(s,o,a)),s.map(function(e,t){if(e){var r=null,o=null,c=null,s=null;return a?(r=e.title.indexOf(a),o=e.title.substr(0,r),c=e.title.substr(r+a.length),s=r>-1?i.a.createElement("span",null,o,i.a.createElement("span",{style:{color:"#f50"}},a),c):e.tree_show?i.a.createElement("span",null,e.title):""):s=e.title,e.children?i.a.createElement(ce.a.TreeNode,{style:{display:s?"block":"none"},title:s,key:e.key,dataRef:e},n.renderTreeNodes(e.children,e)):(e.title=s,i.a.createElement(ce.a.TreeNode,he({style:{display:s?"block":"none"},key:e.key},e)))}})},n.state={checkedKeys:[],selectedKeys:[],expandedKey:[]},n}return Se(t,o["Component"]),ve(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,n=t.selectedKeys,a=t.expandedKey,r=this.props,o=r.expandedKeys,c=r.autoExpandParent,s=r.seek_tree_show,l=(r.expandedKeys_seek,r.seek_show_node),u=r.terrType;o=s?pe()(l):pe()(o);var p=this.props,d=p.checkedKeys;p.type;return i.a.createElement(ce.a,{checkable:!0,autoExpandParent:c,onCheck:this.onCheck,onSelect:this.onSelect,onExpand:function(t,n){n.expanded;var a=n.node;return e.onExpand(t,a)},expandedKeys:1==u?o:a,checkedKeys:d,selectedKeys:n},this.renderTreeNodes(pe()(this.props.menuList)))}}]),t}();function Re(e,t){return e&&e.length?e.map(function(e){return e?{key:t+e.key,title:e.title,children:Re(e.children,t)}:{}}):[]}var Pe,De=function(e){function t(e){var n;be(this,t),(n=Ee(this,ke(t).call(this,e))).rightsList=function(e,t){var a=null;return e.map(function(e,r){a=t?t+"-"+r:"0-"+r;var o=e.boxName||e.groupName;return o&&-1!=o.indexOf("#")&&(o=(o=o.split("#"))[0]),e.title=o,e.key=a,e.subBoxs&&(e.children=n.rightsList(e.subBoxs,e.key)),Le.push(a),e})},n.editList=function(e){e.map(function(e,t){return e.checked&&e.subBoxs&&e.subBoxs.length>0?n.editList(e.subBoxs):e.checked&&Ce.push(e.key),!1})},n.edit=function(e){n.editList(e);var t=pe()(Ce);return Ce=[],t},n.getRights=function(){var e=Object(P.j)("roleId"),t={version:1.2,userCategory:n.state.userCategory},a=!1;e&&(t.roleId=e,a=!0),Object(l.c)(l.a.getRights,t,{loading:!0}).then(function(e){if(0==e.code){for(var t=e.data,r=[],o=[],i=[],c=[],s=[],l=[],u=[],p=[],d=[],f=[],m=[],h=0;h<t.length;h++){var y=t[h];if("productService"==y.menuCode)r=pe()(n.rightsList(y.checkBoxGroupList)),u=pe()(Le),Le=[];if("apiInvok"==y.menuCode)o=pe()(n.rightsList(y.checkBoxGroupList)),p=pe()(Le),Le=[];if("dataObject"==y.menuCode)i=pe()(n.rightsList(y.checkBoxGroupList)),d=pe()(Le),Le=[];if("dataDimension"==y.menuCode)c=pe()(n.rightsList(y.checkBoxGroupList)),f=pe()(Le),Le=[];if("projectAuth"==y.menuCode)s=pe()(n.rightsList(y.checkBoxGroupList)),m=pe()(Le),Le=[];"hideData"==y.menuCode&&(l=y.checkBoxGroupList)}if(a){var b=pe()(n.edit(r)),g=pe()(n.edit(o)),v=pe()(n.edit(i)),E=pe()(n.edit(c)),O=pe()(n.edit(s));n.setState({productResource:r,apiRightsList:o,dataObjRightsList:i,dataDimensionRightsList:c,projectRightsList:s,hideDataList:l,expandedKeys:[],productResource_key_left:b,right_productResource:le()(n.processingData_2(n.processingData_1(n.selectList(r,b,!1,!1,!0)))),dataObjRightsList_key_left:v,right_dataObjRightsList:le()(n.processingData_2(n.processingData_1(n.selectList(i,v,!1,!1,!0)))),dataDimensionRightsList_key_left:E,right_dataDimensionRightsList:le()(n.processingData_2(n.processingData_1(n.selectList(c,E,!1,!1,!0)))),apiRightsList_key_left:g,right_apiRightsList:le()(n.processingData_2(n.processingData_1(n.selectList(o,g,!1,!1,!0)))),projectRightsList_key_left:O,right_projectRightsList:le()(n.processingData_2(n.processingData_1(n.selectList(s,O,!1,!1,!0))))})}else r=n.selectList(r,u),o=n.selectList(o,p),i=n.selectList(i,d),c=n.selectList(c,f),s=n.selectList(s,m),n.setState({productResource:r,productResource_key_left:u,right_productResource:r,apiRightsList:o,apiRightsList_key_left:p,right_apiRightsList:o,dataObjRightsList:i,dataObjRightsList_key_left:d,right_dataObjRightsList:i,dataDimensionRightsList:c,dataDimensionRightsList_key_left:f,right_dataDimensionRightsList:c,projectRightsList:s,projectRightsList_key_left:m,right_projectRightsList:s,hideDataList:l})}})},n.generateList=function(e){for(var t=0;t<e.length;t++){var a=e[t],r=a.key,o=a.title;xe.push({key:r,title:o}),a.children&&n.generateList(a.children)}return xe},n.getParentKey=function(e,t){for(var a,r=0;r<t.length;r++){var o=t[r];o.children&&(o.children.some(function(t){return t.key===e})?a=o.key:n.getParentKey(e,o.children)&&(a=n.getParentKey(e,o.children)))}return a},n.inputOrSelect=function(e,t){switch(e){case 1:n.setState({roleName:t.target.value});break;case 2:n.setState({remark:t.target.value});break;case 3:Ce=[],n.setState({expandedKeys:[],productResource_key_left:[],right_productResource:[],apiRightsList_key_left:[],right_apiRightsList:[],dataObjRightsList_key_left:[],right_dataObjRightsList:[],dataDimensionRightsList_key_left:[],right_dataDimensionRightsList:[],projectRightsList_key_left:[],right_projectRightsList:[]},function(){var e=t.target.value;1==e?n.setState({userCategory:e,permissionAssignment:"1"},function(){n.getRights()}):n.setState({userCategory:e,permissionAssignment:"2"},function(){n.getRights()})});break;case 4:n.setState({expandedKeys_seek:[],seek_show_node:[],seek_tree_show:!1,searchValue:"",expandedKeys:[]},function(){n.setState({permissionAssignment:t})});break;case 5:var a=n.state,r=a.permissionAssignment,o=a.productResource,i=a.apiRightsList,c=a.dataObjRightsList,s=a.dataDimensionRightsList,l=a.projectRightsList,u=[];1==r?u=pe()(o):2==r?u=pe()(c):3==r?u=pe()(s):4==r?u=pe()(i):5==r&&(u=pe()(l));var p=n.generateList(u).map(function(e){return e.title&&e.title.indexOf(t)>-1?n.getParentKey(e.key,u):null}).filter(function(e,t,n){return e&&n.indexOf(e)===t}),d=[];p.map(function(e){d=d.concat(function(e){for(var t=e.split("-"),n=[],a=t[0],r=1;r<t.length;r++)a+="-"+t[r],n.push(a);return n}(e))}),d=Array.from(new Set(d)),n.setState({expandedKeys_seek:pe()(d),searchValue:t,autoExpandParent:!1,seek_tree_show:!0,seek_show_node:pe()(d)})}},n.deleteDate=function(e){return e.map(function(e,t){return delete e.children,e.subBoxs&&n.deleteDate(e.subBoxs),e})},n.onExpand=function(e,t,a){var r=n.state.seek_tree_show;if(1==e)if(r){var o=pe()(t);n.setState({seek_show_node:o,autoExpandParent:a})}else n.setState({expandedKeys:t,autoExpandParent:a});else n.setState({autoExpandParent:a})},n.processingData_2=function(e){return e.map(function(e,t){if(e.checkeds){var a={key:e.key,title:e.title};return e.children&&(a.children=n.processingData_2(e.children)),a}})},n.processingData_1=function(e,t){return e.map(function(e,a){return e.checkeds&&t&&(t.checkeds=!0,t.checked=!0),e.children&&(e.children=n.processingData_1(e.children,e)),e})},n.checkShow=function(e,t){var n=!1;return e.map(function(e){0===e.indexOf(t)&&(n=!0)}),n},n.selectList=function(e,t,a,r,o){var i=pe()(t);return e.map(function(e,t){return o?e.checkeds=e.checked:(e.checkeds=!!n.checkShow(i,e.key),e.checked=!!n.checkShow(i,e.key)),e.checkeds&&r&&(r.checkeds=!0),e.children&&(e.children=n.selectList(e.children,i,e.key,e,o)),e})},n.leftShuttle=function(e,t,a){var r=a.node.props.eventKey,o=n.state,i=o.productResource,c=o.apiRightsList,s=o.dataObjRightsList,l=o.dataDimensionRightsList,u=o.projectRightsList;if(1==e){var p=le()(n.processingData_2(n.processingData_1(n.selectList(i,t))));n.setState({productResource_key_left:t,right_productResource:p}),r="productService-"+r}else if(2==e){var d=le()(n.processingData_2(n.processingData_1(n.selectList(s,t))));n.setState({dataObjRightsList_key_left:t,right_dataObjRightsList:d}),r="dataObject-"+r}else if(3==e){var f=le()(n.processingData_2(n.processingData_1(n.selectList(l,t))));n.setState({dataDimensionRightsList_key_left:t,right_dataDimensionRightsList:f}),r="dataDimension-"+r}else if(4==e){var m=le()(n.processingData_2(n.processingData_1(n.selectList(c,t))));n.setState({apiRightsList_key_left:t,right_apiRightsList:m}),r="api-"+r}else if(5==e){var h=le()(n.processingData_2(n.processingData_1(n.selectList(u,t))));n.setState({projectRightsList_key_left:t,right_projectRightsList:h}),r="projectAuth-"+r}for(var y=r.split("-"),b=y[0],g=[b],v=1;v<y.length-1;v++)b+="-"+y[v],g.push(b);n.refTree.triExpand(g)},n.rightShuttle=function(e,t){},n.removeChecked=function(e){return e.map(function(e,t){return e.checked=!1,e.children&&(e.children=n.removeChecked(e.children)),e})},n.removeAll=function(e){var t=n.state,a=t.productResource,r=t.dataObjRightsList,o=t.dataDimensionRightsList,i=t.apiRightsList,c=t.projectRightsList;n.setState({productResource:n.removeChecked(a),productResource_key_left:[],right_productResource:[],dataObjRightsList:n.removeChecked(r),dataObjRightsList_key_left:[],right_dataObjRightsList:[],dataDimensionRightsList:n.removeChecked(o),dataDimensionRightsList_key_left:[],right_dataDimensionRightsList:[],apiRightsList:n.removeChecked(i),apiRightsList_key_left:[],right_apiRightsList:[],projectRightsList:n.removeChecked(c),projectRightsList_key_left:[],right_projectRightsList:[]})},n.deleteChooseList=function(e,t,n){for(var a=0;a<n.length;a++){for(var r=n[a],o=!1,i="",c=0;c<e.length;c++){if(e[c].split("-")[0]==r){o=!0,i="";break}i=r}if(!o)for(var s=0;s<t.length;s++)t[s].key===i&&t.splice(s,1)}return t};var a=decodeURI(Object(P.j)("roleName"))&&"null"!=decodeURI(Object(P.j)("roleName"))?decodeURI(Object(P.j)("roleName")):"",r=decodeURI(Object(P.j)("remark"))&&"null"!=decodeURI(Object(P.j)("remark"))?decodeURI(Object(P.j)("remark")):"";return n.state={roleName:a||"",remark:r||"",userCategory:Object(P.j)("userCategory")||"1",hideData:[],expandedKeys:[],expandedKeys_seek:[],seek_show_node:[],seek_tree_show:!1,searchValue:"",autoExpandParent:!1,permissionAssignment:2==Object(P.j)("userCategory")?"2":"1",productResource:[],productResource_key_left:[],right_productResource:[],productResource_key_right:[],apiRightsList:[],apiRightsList_key_left:[],right_apiRightsList:[],dataObjRightsList:[],dataObjRightsList_key_left:[],right_dataObjRightsList:[],dataObjRightsList_key_right:[],dataDimensionRightsList:[],dataDimensionRightsList_key_left:[],right_dataDimensionRightsList:[],projectRightsList:[],projectRightsList_key_left:[],right_projectRightsList:[]},n.click_1=n.click_1.bind(Oe(n)),n.click_2=n.click_2.bind(Oe(n)),n}return Se(t,o["Component"]),ve(t,[{key:"componentDidMount",value:function(){this.getRights()}},{key:"click_1",value:function(){this.props.history.push({pathname:"/userCenter/role"})}},{key:"click_2",value:function(){var e=this,t=Object(P.j)("roleId")||"",n=this.state,a=n.roleName,r=n.remark,o=n.userCategory,i=n.productResource,c=n.apiRightsList,s=n.dataObjRightsList,u=n.dataDimensionRightsList,p=n.projectRightsList,d=n.hideDataList,f="";if(""==a?f="请填写角色名":""==r&&(f="请填写备注"),f)Object(X.a)({type:"warn",description:f});else{var m=[],h={roleName:a,userCategory:o,version:1.1};t&&(h.roleId=t),r&&(h.remark=r),m=1==o?[].concat(ye(this.deleteDate(pe()(p))),ye(this.deleteDate(pe()(i))),ye(this.deleteDate(pe()(s))),ye(this.deleteDate(pe()(u))),ye(d)):[].concat(ye(this.deleteDate(pe()(s))),ye(this.deleteDate(pe()(c))),ye(this.deleteDate(pe()(u))),ye(d)),h.dataJson=JSON.stringify(m),Object(l.d)(l.a.saveRole,h,{loading:!0}).then(function(t){0==t.code&&(Object(X.a)({type:"success",description:"用户角色保存成功！"}),e.props.history.push({pathname:"/userCenter/role"}))})}}},{key:"render",value:function(){var e=this,t=this.state,n=t.productResource,a=t.apiRightsList,r=t.dataObjRightsList,o=t.dataDimensionRightsList,c=t.projectRightsList,s=t.expandedKeys,l=t.expandedKeys_seek,u=t.seek_show_node,d=t.seek_tree_show,f=t.searchValue,m=t.autoExpandParent,y=t.productResource_key_left,g=t.dataObjRightsList_key_left,v=t.dataDimensionRightsList_key_left,E=t.apiRightsList_key_left,O=t.projectRightsList_key_left,k=t.right_productResource,S=t.right_dataObjRightsList,w=t.right_dataDimensionRightsList,j=t.right_apiRightsList,_=t.right_projectRightsList,I=t.roleName,x=t.remark,C=t.userCategory,L=t.permissionAssignment,N=[{key:"dataObject",title:"数据对象权限",children:Re(pe()(S),"dataObject-")},{key:"dataDimension",title:"数据维度",children:Re(pe()(w),"dataDimension-")}],R=[].concat(ye(g.map(function(e){return"dataObject-"+e})),ye(v.map(function(e){return"dataDimension-"+e})));1==C?(N.unshift({key:"productService",title:"产品服务权限",children:Re(pe()(k),"productService-")}),R=R.concat(y.map(function(e){return"productService-"+e})),N.push({key:"projectAuth",title:"项目权限",children:Re(pe()(_),"projectAuth-")}),R=R.concat(O.map(function(e){return"projectAuth-"+e}))):(N.push({key:"api",title:"API调用权限",children:Re(pe()(j),"api-")}),R=R.concat(E.map(function(e){return"api-"+e})));var D=[],T=[];1==L?(D=pe()(n),T=y,pe()(k)):2==L?(D=pe()(r),T=g,pe()(S)):3==L?(D=pe()(o),T=v,pe()(w)):4==L?(D=pe()(a),T=E,pe()(j)):5==L&&(D=pe()(c),T=O,pe()(_));var F=!!Object(P.j)("roleId");return this.deleteChooseList(R,N,["productService","dataObject","dataDimension","api"]),i.a.createElement("div",{className:"role-add"},i.a.createElement(p.a,{backHandle:function(){return e.props.history.goBack()},title:F?"编辑角色":"创建角色"}),i.a.createElement("div",{className:"commonContentBox"},i.a.createElement("div",{className:"title"},"基础信息"),i.a.createElement("div",{className:"centent"},i.a.createElement("div",{className:"common_title_input"},i.a.createElement("span",{className:"common_title mustiinput"},"用户角色名:"),i.a.createElement("div",{className:"common_content"},i.a.createElement(h.a,{className:"input",maxLength:20,value:I,placeholder:"20个字符以内",allowClear:!0,onChange:this.inputOrSelect.bind(this,1)}))),i.a.createElement("div",{className:"common_title_input"},i.a.createElement("span",{className:"common_title mustiinput"},"备注:"),i.a.createElement("div",{className:"common_content"},i.a.createElement(h.a,{className:"input",maxLength:20,value:x,placeholder:"20个字符以内",allowClear:!0,onChange:this.inputOrSelect.bind(this,2)}))),i.a.createElement("div",{className:"common_title_input"},i.a.createElement("span",{className:"common_title"},"访问方式:"),i.a.createElement("div",{className:"common_content"},F?i.a.createElement("span",{style:{lineHeight:"32px"}},1==C?"控制台访问":"接口访问"):i.a.createElement(ie.a.Group,{defaultValue:"1",onChange:this.inputOrSelect.bind(this,3)},i.a.createElement(ie.a,{value:"1"},"控制台权限"),i.a.createElement(ie.a,{value:"2"},"接口访问")))))),i.a.createElement("div",{className:"commonContentBox"},i.a.createElement("div",{className:"title"},"权限配置",F?null:i.a.createElement("span",{className:"postil"},"*注：新建角色进入时，所有权限默认全部选中")),i.a.createElement("div",{className:" jurisdiction-box ratio"},i.a.createElement("div",{className:"common_content"},i.a.createElement(b.a,{value:L,style:{width:150},onChange:this.inputOrSelect.bind(this,4)},1==C?_e.map(function(e,t){return i.a.createElement(je,{key:e.id+"consoleList",value:e.id},e.text)}):Ie.map(function(e,t){return i.a.createElement(je,{key:e.id+"apiList",value:e.id},e.text)})),"    ",i.a.createElement(h.a.Search,{style:{width:"188px"},placeholder:"请输入关键字查找",maxLength:20,onSearch:this.inputOrSelect.bind(this,5),enterButton:!0}))),i.a.createElement("div",{className:" jurisdiction-box placeholder"}),i.a.createElement("div",{className:"tree-fer"},i.a.createElement("div",{className:"jurisdiction"},D.length>0?i.a.createElement(Ne,{shuttle:this.leftShuttle.bind(this,L),menuList:D,expandedKeys:s,seek_tree_show:d,expandedKeys_seek:l,checkedKeys:T,searchValue:f,autoExpandParent:m,onExpand:this.onExpand.bind(this,1),seek_show_node:u,terrType:1,type:"left"}):i.a.createElement(fe.a,null)),i.a.createElement("div",{className:"shuttle"}),i.a.createElement("div",{className:"jurisdiction-select-show"},i.a.createElement("span",{className:"common_title"},"已选权限:"),i.a.createElement("div",{className:"select-show-box"},i.a.createElement(Ne,{shuttle:this.rightShuttle.bind(this,L),menuList:N,checkedKeys:R,onExpand:this.onExpand.bind(this,2),terrType:2,type:"right",ref:function(t){return e.refTree=t}})),i.a.createElement("div",{className:"empty",onClick:this.removeAll.bind(this,L)},"全部清除")))),i.a.createElement(de.a,{preHandle:this.click_1,preText:"取消",nextHandle:this.click_2,nextText:F?"保存角色":"创建角色"}))}}]),t}(),Te=(n("k3Gp"),n("kLXV")),Fe=(n("TfFZ"),n("3S7+")),Ae=n("FC04"),Ve=(n("Jmwx"),n("BMrR")),Me=(n("2oDE"),n("CtXQ")),Ke=(n("rO+z"),n("kPKH")),Ue=n("Zsd2"),Be=n.n(Ue),qe=n("rwTb"),We=n("M7r8");n("ccuU");function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(){return(Je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function He(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ze(e,t){return!t||"object"!==Ge(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ze(e){return(Ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qe=b.a.Option,$e=[{id:1,text:"自动生成默认密码"},{id:2,text:"手动设置登录密码"}],Xe=Object(s.b)(function(e){return{developerInfo:e.getIn(["userCenter","developerInfo"]).toJS()}},null)(Pe=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ze(this,Ze(t).call(this,e))).addUserList=function(){var e=n.state.userNameList;if(e.length>=10)return Object(X.a)({description:"添加用户一次最多添加10个！"}),!1;e.push(""),n.setState({userNameList:e})},n.deleteUserList=function(e){var t=n.state.userNameList;t.splice(e,1),n.setState({userNameList:t})},n.accountSelect=function(e){n.setState({userCategory:e}),n.props.form.resetFields("roleId")},n.roleSelect=function(e){n.setState({roleId:e})},n.resetSelect=function(e){1==e?(n.setState({resetSelectId:e}),setTimeout(function(){n.props.form.setFieldsValue({password:"a123456"})},100)):(n.setState({resetSelectId:e}),n.props.form.setFieldsValue({password:""}))},n.userName=function(e,t){var a=n.state.userNameList;a[e]=t.target.value,n.setState({userNameList:a})},n.passwordInput=function(e){n.setState({password:e.target.value})},n.ipWhiteSelectFunc=function(e){n.setState({ipWhiteSelect:e})},n.ipWhiteListFunc=function(e){n.setState({ipWhiteList:e.target.value})},n.remark=function(e){n.setState({remark:e.target.value})},n.affirm=function(e){e.preventDefault(),(0,n.props.form.validateFieldsAndScroll)(function(e,t){if(!e){for(var a=n.state,r=a.userNameList,o=a.userCategory,i=a.ipWhiteSelect,c=0;c<r.length;c++){if(r[c]=Be()(r[c]),!r[c])return Object(X.a)({description:"请填写用户名称！"}),!1;if(r[c]=r[c].split("@")[0],!Object(P.d)(r[c]))return Object(X.a)({description:"请正确格式的用户名称！大小写字母+数字6~14位"}),!1}for(var s=0;s<r.length;s++)for(var u=r[s],p=s+1;p<r.length;p++){if(u==r[p])return Object(X.a)({description:"第"+(s+1)+"跟第"+(p+1)+"个用户名重复，请重新输入！"}),!1}for(var d=0;d<r.length;d++)r[d]=r[d]+"@"+n.props.developerInfo.id;var f={userNameList:r,roleId:t.roleId,userCategory:t.userCategory};if(1==o&&t.password&&(f.password=Object(P.i)(t.password)),2==o&&i){var m=t.ipWhiteList;if(m){if(m.split(",").length>10)return Object(X.a)({description:"IP白名单最多添加10条！"}),!1;f.ipWhiteList=m}}t.remark&&(f.remark=t.remark),Object(l.d)(l.a.addMultiChild,f,{needJson:!0}).then(function(e){0==e.code&&(Object(X.a)({type:"success",description:"用户创建成功！"}),n.setState({userNameList:[""],userCategory:1,roleId:null,resetSelectId:"",password:"",ipWhiteSelect:!1,ipWhiteList:"",remark:""},function(){n.props.form.resetFields(),n.props.onAddClose(),n.props.pagerIndex(1)}))})}})},n.passwordCheck=function(e,t,n){/^^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,18}$/.test(t)?n():n("密码格式为大小写字母加数字，长度为6-18")},n.state={userNameList:[""],userCategory:1,roleList_1:[],roleList_2:[],roleId:null,resetSelectId:"",password:"",ipWhiteSelect:!1,ipWhiteList:"",remark:""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;this.props.onRef(this),Object(l.c)(l.a.getRoleList).then(function(t){if(0==t.code){for(var n=[],a=[],r=0;r<t.data.length;r++){var o=t.data[r];1==o.userCategory?n.push(o):a.push(o)}e.setState({roleList_1:n,roleList_2:a})}})}},{key:"render",value:function(){var e=this,t=this.props.form,n=t.getFieldDecorator,a=t.getFieldValue,r=this.state,o=r.userCategory,c=(r.roleId,r.resetSelectId),s=(r.ipWhiteSelect,r.ipWhiteList,r.password,r.remark),l=r.userNameList,u=r.roleList_1,p=r.roleList_2;o=a("userCategory"),c=a("resetSelectId");var d=1==o?u:p,y=this.props.developerInfo.id;return i.a.createElement(m.a,Je({},{labelCol:{xs:{span:5},sm:{span:5}},wrapperCol:{xs:{span:19},sm:{span:19}}},{onSubmit:this.affirm,className:"add-user-box"}),i.a.createElement("div",{className:"add-user-box"},i.a.createElement("div",{className:"common_title_input"},i.a.createElement(Ve.a,{gutter:8},i.a.createElement(Ke.a,{span:5,className:"label"},i.a.createElement("span",{className:"form-require on-require"},i.a.createElement(qe.a,{label:"用户名",tip:"控制台访问时的登录名。"}))),i.a.createElement(Ke.a,{span:19},l.map(function(t,a){return i.a.createElement("div",{className:"uesrName",key:"productName"+a},i.a.createElement(m.a.Item,{label:"",hasFeedback:!0,colon:!1},n("productName_"+a,{rules:[{required:!0,min:6,max:14,message:"请输入6~14位大小写字母＋数字"}]})(i.a.createElement(h.a,{className:"input",style:{width:"300px"},placeholder:"请输入用户名称",suffix:"@"+y,onChange:e.userName.bind(e,a)}))),a>0?i.a.createElement("span",{className:"delete",onClick:e.deleteUserList.bind(e,a)},i.a.createElement(Me.a,{type:"close-circle"})):null)}))),i.a.createElement("span",{className:"addUesr explainLink-N",onClick:this.addUserList},"添加用户")),i.a.createElement("div",{className:"common_title_input"},i.a.createElement(m.a.Item,{label:"账户类型",hasFeedback:!0},n("userCategory",{rules:[{required:!0,message:"请选择账户类型"}],initialValue:1})(i.a.createElement(b.a,{style:{width:"180px"},onChange:this.accountSelect},i.a.createElement(Qe,{key:"1账户类型",value:1},"控制台访问用户"),i.a.createElement(Qe,{key:"2账户类型",value:2},"接口访问用户"))))),i.a.createElement("div",{className:"common_title_input"},i.a.createElement(m.a.Item,{label:"用户角色",hasFeedback:!0},n("roleId",{rules:[{required:!0,message:"请选择用户角色"}]})(i.a.createElement(b.a,{showSearch:!0,style:{width:"180px"},placeholder:"请选择",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},d.map(function(e,t){return i.a.createElement(Qe,{key:t+"用户角色",value:e.roleId},e.roleName)}))))),1==o?i.a.createElement("div",{className:"common_title_input"},i.a.createElement("div",{className:"reset-select"},i.a.createElement(m.a.Item,{label:"登录密码",hasFeedback:!0},n("resetSelectId",{rules:[{required:!0,message:"请选择密码生成方式"}]})(i.a.createElement(b.a,{style:{width:"180px"},placeholder:"请选择",onChange:this.resetSelect},$e.map(function(e,t){return i.a.createElement(Qe,{key:t+"登录密码",value:e.id},e.text)})))),c?i.a.createElement(m.a.Item,{label:" ",colon:!1},n("password",{rules:[{required:!0,validator:this.passwordCheck,message:"密码格式为大小写字母加数字，长度为6-18"}]})(1==c?i.a.createElement(h.a,{style:{width:"240px"},disabled:!0}):i.a.createElement(h.a.Password,{style:{width:"240px"},placeholder:"密码格式为大小写字母加数字，长度为6-18"}))):null)):null,null,i.a.createElement("div",{className:"common_title_input"},i.a.createElement(We.a,{label:"备注",formId:"remark",astrictNub:"100",rows:"2",placeholder:"请输入备注",getFieldDecorator:n,initialVal:s,width:"300px",getFieldValue:a}))),i.a.createElement("div",{className:"but"},i.a.createElement(f.a,{type:"primary",htmlType:"submit"},"确定"),i.a.createElement(f.a,{className:"cancel",onClick:this.props.onCancel},"取消")))}}])&&He(n.prototype,a),r&&He(n,r),t}())||Pe,et=m.a.create({name:"addUserInfo"})(Xe);n("y1Sk");function tt(e){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ot(e,t){return(ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var it=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=at(t).call(this,e),(n=!r||"object"!==tt(r)&&"function"!=typeof r?rt(a):r).getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(l.c)(l.a.getChildlist,e).then(function(e){n.setState({userList:e.data.list,pager:e.data.pager,loading:!1})})},n.addUser=function(){n.setState({addUserVisible:!0})},n.searchProduct=function(e){n.state.pageIndex;n.setState({loading:!0,userName:e},function(){n.pagerIndex(1)})},n.examine=function(e,t){window.location.hash="#/userCenter/look?userId=".concat(e,"&userCategory=").concat(t)},n.startOrForbidden=function(e,t,a){1==e?n.setState({forbiddenModalVisible:!0,userName:t,userId:a}):0==e&&n.setState({startModalVisible:!0,userName:t,userId:a})},n.startModal=function(e){if(1==e){var t=n.state,a=t.userId,r=t.pageIndex;r=r||1,Object(l.c)(l.a.unfreezeChild,{userId:a}).then(function(e){0==e.code&&n.setState({loading:!0},function(){n.getList({pageIndex:r,pageRows:10})})})}n.setState({startModalVisible:!1})},n.forbiddenModal=function(e){if(1==e){var t=n.state,a=t.userId,r=t.pageIndex;r=r||1,Object(l.c)(l.a.freezeChild,{userId:a}).then(function(e){0==e.code&&n.setState({loading:!0},function(){n.getList({pageIndex:r,pageRows:10})})})}n.setState({forbiddenModalVisible:!1})},n.delete=function(e){n.setState({deleteModalVisible:!0,userId:e})},n.inputOnChangeHandle=function(e){n.setState({deleteInputValue:e.target.value})},n.deleteModal=function(e){if(1==e){if("delete"!=n.state.deleteInputValue)return Object(X.a)({type:"info",description:"请输入delete确认删除！"}),!1;var t=n.state,a=t.userId,r=t.pageIndex,o=t.pager;r=r||1,Object(l.c)(l.a.deleteChild,{userId:a}).then(function(e){0==e.code&&n.setState({loading:!0,deleteInputValue:""},function(){r=o.totalRows%(10*(r-1))>1?r:r-1,n.getList({pageIndex:r,pageRows:10})})})}n.setState({deleteModalVisible:!1})},n.addUserModal=function(e){1==e?n.addUserRefs.affirm():(n.setState({addUserVisible:!1}),n.addUserRefs.setState({userNameList:[""],userCategory:1,roleId:null,resetSelectId:"",password:"",ipWhiteSelect:!1,ipWhiteList:"",remark:""}),n.addUserRefs.props.form.resetFields())},n.closeAdd=function(){n.setState({addUserVisible:!1})},n.pagerIndex=function(e){n.setState({pageIndex:e,loading:!0},function(){n.getList({pageIndex:e,pageRows:10,userName:n.state.userName||void 0})})},n.state={loading:!0,userList:[],pager:{},addUserVisible:!1,userName:"",userId:"",startModalVisible:!1,forbiddenModalVisible:!1,deleteModalVisible:!1,deleteInputValue:"",deleteId:"",pageIndex:""},n.columns=[{title:"用户名",dataIndex:"userName",key:"userName",render:function(e){return i.a.createElement(Fe.a,{placement:"topLeft",title:e},i.a.createElement("a",null,e))}},{title:"用户角色",dataIndex:"roleName",key:"roleName",render:function(e){return i.a.createElement(Fe.a,{placement:"topLeft",title:e}," ",i.a.createElement("span",null,e)," ")}},{title:"账户类型",dataIndex:"userCategory",key:"userCategory",width:"170px",render:function(e){return i.a.createElement("span",null,i.a.createElement(Y.a,{color:1==e?"blue":"green"},1==e?"控制台访问用户":"接口访问用户"))}},{title:"备注",dataIndex:"remark",key:"remark",render:function(e){return i.a.createElement(Fe.a,{placement:"topLeft",title:e}," ",i.a.createElement("span",null,e)," ")}},{title:"用户状态",dataIndex:"status",key:"status",width:"100px",render:function(e,t){return 1==t.status?i.a.createElement("span",{className:"colordot colordotgreen"},"正常"):i.a.createElement("span",{className:"colordot colordotred"},"停用")}},{title:"创建时间",dataIndex:"regTime",key:"regTime",width:"160px",render:function(e){return i.a.createElement("span",null,$()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss"))}},{title:"操作",key:"action",width:"140px",render:function(e,t){return i.a.createElement("span",null,i.a.createElement("a",{onClick:n.examine.bind(rt(n),t.userId,t.userCategory)},"查看"),i.a.createElement(Z.a,{type:"vertical"}),1==t.status?i.a.createElement("a",{onClick:n.startOrForbidden.bind(rt(n),1,t.userName,t.userId),style:{color:"#FF3100"}},"停用"):i.a.createElement("a",{onClick:n.startOrForbidden.bind(rt(n),0,t.userName,t.userId)},"启用"),i.a.createElement(Z.a,{type:"vertical"}),i.a.createElement("a",{onClick:n.delete.bind(rt(n),t.userId)},"删除"))}}],n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ot(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this.getList({pageIndex:1,pageRows:10})}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.userName,r=t.addUserVisible,o=t.startModalVisible,c=t.forbiddenModalVisible,s=t.deleteModalVisible,l=t.deleteInputValue,u=t.userList,p=t.pager;return i.a.createElement("div",{className:"user-visit-box"},i.a.createElement("header",{className:"page-content-header"},i.a.createElement("h3",{className:"page-name"},"访问用户"),i.a.createElement("div",null,i.a.createElement("div",{className:"searchBox"},i.a.createElement(h.a.Search,{placeholder:"请输入用户名查找",enterButton:!0,maxLength:20,onSearch:function(t){return e.searchProduct(t)}})),i.a.createElement("div",{className:"butFloatRight"},i.a.createElement(f.a,{className:"but-add",type:"primary",onClick:this.addUser},"创建用户")))),i.a.createElement("div",{className:"commonContentBox"},i.a.createElement("div",{className:"centent"},i.a.createElement(H.a,{rowKey:"userId",columns:this.columns,dataSource:u,pagination:{defaultCurrent:p.pageIndex,total:p.totalRows,hideOnSinglePage:!1,onChange:this.pagerIndex,current:p.pageIndex},loading:n}))),i.a.createElement(Te.a,{title:"创建用户",visible:r,onOk:this.addUserModal.bind(this,1),onCancel:this.addUserModal.bind(this,2),maskClosable:!1,className:"self-modal",footer:null},i.a.createElement(et,{onAddClose:this.closeAdd,onCancel:this.addUserModal.bind(this,2),pagerIndex:this.pagerIndex,onRef:function(t){return e.addUserRefs=t}})),i.a.createElement(Ae.a,{visible:o,modalOKHandle:this.startModal.bind(this,1),modalCancelHandle:this.startModal.bind(this,2),title:"启用用户",tipText:"启用用户后，该用户将恢复访问。",descText:"即将启用用户",targetName:a}),i.a.createElement(Ae.a,{visible:c,modalOKHandle:this.forbiddenModal.bind(this,1),modalCancelHandle:this.forbiddenModal.bind(this,2),title:"停用用户",tipText:"停用用户后，该用户将暂时无法访问，您可以重新启用账户。",descText:"即将停用用户",needWarnIcon:!0,targetName:a}),i.a.createElement(Ae.a,{visible:s,modalOKHandle:this.deleteModal.bind(this,1),modalCancelHandle:this.deleteModal.bind(this,2),title:"删除用户",tipText:"删除用户将同步删除UUID和用户SecretKey，无法找回，请谨慎操作。",descText:"即将删除用户",needWarnIcon:!0,targetName:a},i.a.createElement(h.a,{className:"modal-content-input",onChange:this.inputOnChangeHandle,placeholder:"请输入“delete”确认删除该用户",maxLength:20,value:l})))}}])&&nt(n.prototype,a),r&&nt(n,r),t}(),ct=n("S18n");function st(e){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ut(e,t){return!t||"object"!==st(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pt(e){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dt(e,t){return(dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ft,mt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ut(this,pt(t).call(this,e))).state={},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dt(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.userInfo,n=e.secretKey,a=e.secretId,r=function(e){var t=e.title,n=e.label,a=e.type;return i.a.createElement("p",{className:"list-item"},i.a.createElement("span",{className:"title"},t,"："),"visible"===a?i.a.createElement(ct.a,{label:n||"",tip:"点击复制",copy:!0}):i.a.createElement("span",null,n))};return i.a.createElement("div",{className:"basic-information-box"},i.a.createElement(f.a,{className:"but-edit basic-information-edit",type:"primary",onClick:this.props.editUserInfo},"编辑"),i.a.createElement(d.a,{title:"基础信息"},i.a.createElement("div",{className:"device-info"},i.a.createElement(r,{title:"用户名",label:t.userName||"--"}),i.a.createElement(r,{title:"用户ID",label:t.userId||"--"}),i.a.createElement(r,{title:"账户类型",label:1==t.userCategory?"控制台访问用户":2==t.userCategory?"接口访问用户":"--"}),i.a.createElement(r,{title:"用户角色",label:t.roleName||"--"}),2==t.userCategory&&i.a.createElement(r,{title:"用户secretId",label:a,type:"visible"}),2==t.userCategory&&i.a.createElement(r,{title:"用户SecretKey",label:n,type:"visible"}),i.a.createElement(r,{title:"创建时间",label:P.a.utcToDev(t.regTime)}),i.a.createElement(r,{title:"最新修改时间",label:P.a.utcToDev(t.modifyTime)})),i.a.createElement("p",{className:"userlook-mark"},i.a.createElement("span",null,"备注："),t.remark)))}}])&&lt(n.prototype,a),r&&lt(n,r),t}(),ht=(n("+vQn"),n("Sdc0"));n("7TnZ");function yt(e){return(yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bt(){return(bt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function gt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function vt(e,t){return!t||"object"!==yt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Et(e){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ot(e,t){return(Ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kt=b.a.Option,St=[{id:1,text:"自动生成默认密码"},{id:2,text:"手动设置登录密码"}],wt=Object(s.b)(function(e){return{developerInfo:e.getIn(["userCenter","developerInfo"]).toJS()}},null)(ft=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=vt(this,Et(t).call(this,e))).backfill=function(e){n.setState({userName:e.userName||null,remark:e.remark||"",roleId:e.roleId||null,ipWhiteSelect:!!e.ipWhiteList,ipWhiteList:e.ipWhiteList,resetChecked:!1})},n.roleSelect=function(e){n.setState({roleId:e})},n.reset=function(e){n.setState({resetChecked:e})},n.resetSelect=function(e){1==e?(n.setState({resetSelectId:e}),setTimeout(function(){n.props.form.setFieldsValue({password:"a123456"})},100)):(n.setState({resetSelectId:e}),n.props.form.setFieldsValue({password:""}))},n.passwordInput=function(e){n.setState({password:e.target.value})},n.ipWhiteSelectFunc=function(e){n.setState({ipWhiteSelect:e})},n.ipWhiteListFunc=function(e){n.setState({ipWhiteList:e.target.value})},n.userName=function(e){n.setState({userName:e.target.value})},n.remark=function(e){n.setState({remark:e.target.value})},n.affirm=function(e){e.preventDefault(),(0,n.props.form.validateFieldsAndScroll)(function(e,t){if(!e){var a=n.state,r=a.resetChecked,o=a.ipWhiteSelect,i=n.props.userData,c=i.userId,s=i.userCategory,u=t.roleId,p=(t.userName,t.password),d=t.ipWhiteList,f=t.remark,m={userId:c,roleIds:u};if(1==s&&r&&(m.password=Object(P.i)(p)),2==s&&o){if(d){if(d.split(",").length>10)return Object(X.a)({description:"IP白名单最多添加10条！"}),!1;m.ipWhiteList=d}}else 2!=s||o||(m.ipWhiteList="");f&&(m.remark=f),Object(l.d)(l.a.updateChild,m,{needFormData:!0,loading:!0}).then(function(e){0==e.code&&n.props.handleClose()})}})},n.passwordCheck=function(e,t,n){/^^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,18}$/.test(t)?n():n("密码格式为大小写字母加数字，长度为6-18")},n.state={resetChecked:!1,resetSelectId:null,password:null,userName:n.props.userData.userName||null,remark:n.props.userData.remark||"",roleId:n.props.userData.roleId||null,roleList_1:[],roleList_2:[],ipWhiteSelect:!!n.props.userData.ipWhiteList,ipWhiteList:n.props.userData.ipWhiteList},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ot(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;this.props.onRef(this),Object(l.c)(l.a.getRoleList).then(function(t){if(0==t.code){for(var n=[],a=[],r=0;r<t.data.length;r++){var o=t.data[r];1==o.userCategory?n.push(o):a.push(o)}e.setState({roleList_1:n,roleList_2:a})}})}},{key:"render",value:function(){var e=this.state,t=e.resetChecked,n=e.remark,a=e.userName,r=e.roleId,o=e.roleList_1,c=e.roleList_2,s=(e.ipWhiteSelect,e.ipWhiteList,this.props.form),l=s.getFieldDecorator,u=s.getFieldValue,p=t?u("resetSelectId"):null,d=(this.props.developerInfo.id,[]),y=this.props.userData.userCategory;d=1==y?o:c;return i.a.createElement(m.a,bt({},{labelCol:{xs:{span:5},sm:{span:5}},wrapperCol:{xs:{span:19},sm:{span:19}}},{onSubmit:this.affirm,className:"edit-basic-information"}),i.a.createElement("div",{className:"common_title_input"},i.a.createElement("span",{className:"common_title"},"用户名:"),i.a.createElement("div",{className:"common_content"},a)),i.a.createElement("div",{className:"common_title_input"},i.a.createElement("span",{className:"common_title"},"账户类型:"),i.a.createElement("div",{className:"common_content"},1==y?"控制台访问用户":2==y?"接口访问用户":"--")),i.a.createElement("div",{className:"common_title_input"},i.a.createElement(m.a.Item,{label:"用户角色",hasFeedback:!0},l("roleId",{rules:[{required:!0,message:"请选择用户角色"}],initialValue:r})(i.a.createElement(b.a,{style:{width:"180px"},placeholder:"请选择"},d.map(function(e,t){return i.a.createElement(kt,{key:t+"用户角色",value:e.roleId},e.roleName)}))))),1==y?i.a.createElement("div",{className:"common_title_input"},i.a.createElement(m.a.Item,{label:"重置密码："},l("resetChecked")(i.a.createElement(ht.a,{size:"small",checked:t,onClick:this.reset}))),t?i.a.createElement("div",{className:"reset-select"},i.a.createElement(m.a.Item,{label:" ",colon:!1},l("resetSelectId",{rules:[{required:!0,message:"请选择密码生成方式"}]})(i.a.createElement(b.a,{style:{width:"180px"},placeholder:"请选择密码生成方式",onChange:this.resetSelect},St.map(function(e,t){return i.a.createElement(kt,{key:t+"登录密码",value:e.id},e.text)})))),p?i.a.createElement(m.a.Item,{label:" ",colon:!1},l("password",{rules:[{required:!0,validator:this.passwordCheck,message:"密码格式为大小写字母加数字，长度为6-18"}]})(1==p?i.a.createElement(h.a,{style:{width:"240px"},disabled:!0}):i.a.createElement(h.a.Password,{style:{width:"240px"},placeholder:"密码格式为大小写字母加数字，长度为6-18"}))):null):null):null,null,i.a.createElement("div",{className:"common_title_input"},i.a.createElement(We.a,{label:"备注",formId:"remark",astrictNub:"100",rows:"2",placeholder:"请输入备注",getFieldDecorator:l,initialVal:n,width:"300px",getFieldValue:u})),i.a.createElement("div",{className:"but"},i.a.createElement(f.a,{type:"primary",htmlType:"submit"},"确定"),i.a.createElement(f.a,{className:"cancel",onClick:this.props.onCancel},"取消")))}}])&&gt(n.prototype,a),r&&gt(n,r),t}())||ft,jt=m.a.create({name:"editBasicInformation"})(wt);n("kmdx");function _t(e){return(_t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(){return(It=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function xt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ct(e,t){return!t||"object"!==_t(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lt(e){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nt(e,t){return(Nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rt=ce.a.TreeNode,Pt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ct(this,Lt(t).call(this,e))).getChildWithSecret=function(){var e=Object(P.j)("userId"),t=Object(P.j)("userCategory");Object(l.c)(l.a.getChildWithSecret,{userId:e,userCategory:t},{loading:!0}).then(function(e){n.setState({userInfo:e.data,loading:!1,secretKey:e.data.secretKey,secretId:e.data.secretId})})},n.clickEye=function(e){n.setState({eye:!n.state.eye})},n.renderTreeNodes=function(e){return e.map(function(e){return e.children?i.a.createElement(Rt,{title:e.title,key:e.key,dataRef:e},n.renderTreeNodes(e.children)):i.a.createElement(Rt,It({key:e.key},e))})},n.handleOk=function(){n.editAffirm.affirm()},n.handleOkCancel=function(){n.editAffirm.setState({resetChecked:!1,resetSelectId:null,password:null,userName:"",remark:"",roleId:null,ipWhiteSelect:!1,ipWhiteList:""},function(){n.getChildWithSecret(),n.getRights()}),n.setState({userEditVisible:!1}),console.log("---close"),n.editAffirm.props.form.resetFields()},n.handleCancel=function(e,t){n.setState({userEditVisible:!1}),console.log("---close"),n.editAffirm.props.form.resetFields(),console.log(n.editAffirm.props.form.getFieldsValue())},n.editUserInfo=function(){n.editAffirm&&n.editAffirm.backfill(n.state.userInfo),n.setState({userEditVisible:!0})},n.state={permissionsTabsKey:"1",userEditVisible:!1,userInfo:{},loading:!0,dataTable:[],secretKey:"",secretId:"",productResource:[],dataObjRightsList:[],dataDimensionRightsList:[],apiInvokList:[],projectAuthList:[],eye:!0},n.columns=[{title:"用户SecretId",dataIndex:"secretId",key:"secretId"},{title:"用户SecretKey",dataIndex:"secret",key:"secret",render:function(e){return i.a.createElement("a",null,n.state.eye?Object(P.r)(e,10):e,n.state.eye?i.a.createElement(Me.a,{className:"eyeLeft",type:"eye-invisible",onClick:n.clickEye}):i.a.createElement(Me.a,{className:"eyeLeft",type:"eye",onClick:n.clickEye}))}},{title:"创建时间",dataIndex:"time",key:"time"}],n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nt(e,t)}(t,o["Component"]),n=t,(a=[{key:"getRights",value:function(){var e=this,t=Object(P.j)("userId"),n=Object(P.j)("userCategory");Object(l.c)(l.a.getRights,{userId:t,userCategory:n},{needVersion:1.2,loading:!0}).then(function(t){for(var n=[],a=[],r=[],o=[],i=[],c=t.data,s=0;s<c.length;s++){var l=c[s];"productService"==l.menuCode&&(n=l.checkBoxGroupList),"dataObject"==l.menuCode&&(a=l.checkBoxGroupList),"dataDimension"==l.menuCode&&(r=l.checkBoxGroupList),"apiInvok"==l.menuCode&&(o=l.checkBoxGroupList),"projectAuth"==l.menuCode&&(i=l.checkBoxGroupList)}e.setState({productResource:n,dataObjRightsList:a,dataDimensionRightsList:r,apiInvokList:o,projectAuthList:i})})}},{key:"componentDidMount",value:function(){this.getChildWithSecret(),this.getRights()}},{key:"render",value:function(){var e=this,t=this.state,n=t.userInfo,a=t.secretKey,r=t.secretId,o=t.userEditVisible,c=t.productResource,s=t.dataObjRightsList,l=t.dataDimensionRightsList,u=t.apiInvokList,d=t.projectAuthList;return i.a.createElement("div",{className:"user-info-box"},i.a.createElement(p.a,{backHandle:function(){return e.props.history.goBack()},title:"用户详情"}),i.a.createElement(mt,{editUserInfo:this.editUserInfo,userInfo:n,secretKey:a,secretId:r}),i.a.createElement(R.a,{defaultExpandAll:!0,userCategory:n.userCategory,productResource:c,dataObjRightsList:s,dataDimensionRightsList:l,apiInvokList:u,projectAuthList:d}),i.a.createElement(Te.a,{title:"编辑用户信息",visible:o,onOk:this.handleOk,onCancel:this.handleCancel,maskClosable:!1,className:"self-modal",footer:null},i.a.createElement(jt,{userData:n,onCancel:this.handleCancel,onRef:function(t){return e.editAffirm=t},handleClose:this.handleOkCancel})))}}])&&xt(n.prototype,a),r&&xt(n,r),t}(),Dt=(n("U8R4"),n("+eQT"));n("hZG8");function Tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Ft(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function At(e){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(a=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Mt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ut(e,t,n){return t&&Kt(e.prototype,t),n&&Kt(e,n),e}function Bt(e,t){return!t||"object"!==At(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qt(e){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gt(e,t)}function Gt(e,t){return(Gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jt=Dt.a.RangePicker,Ht=b.a.Option,zt=function(e){function t(){var e,n;Mt(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Bt(this,(e=qt(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault();var t=n.props,a=t.form,r=t.searchLog;a.validateFields(function(e,t){if(!e){var n=t.time,a=void 0===n?[]:n,o=t.userName,i=t.type,c=t.theme,s=Vt(a,2),l=s[0],u=void 0===l?"":l,p=s[1],d=void 0===p?"":p;u&&(u=1e3*(u.hour(0).minute(0).second(0).millisecond(0).unix()-28800)),d&&(d=1e3*(d.hour(0).minute(0).second(0).millisecond(0).unix()-28800)),r({userName:o,type:i,theme:c,startTime:u,endTime:d})}})},n.disabledDate=function(e){return e&&(e>$()().endOf("day")||e<$()().add(-180,"d").endOf("day"))},n.reset=function(){n.props.form.resetFields()},n}return Wt(t,o["Component"]),Ut(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return i.a.createElement(m.a,{layout:"inline",onSubmit:this.handleSubmit},i.a.createElement("div",{className:"searchCriteria limit-label"},i.a.createElement(m.a.Item,{label:"操作人"},e("userName",{rules:[],initialValue:""})(i.a.createElement(h.a,{style:{width:"220px"},placeholder:"请输入操作人"}))),i.a.createElement(m.a.Item,{label:"操作分类"},e("type",{rules:[],initialValue:""})(i.a.createElement(b.a,{style:{width:"220px"}},i.a.createElement(Ht,{value:""},"请选择"),i.a.createElement(Ht,{value:"0"},"基本操作"),i.a.createElement(Ht,{value:"1"},"产品操作"),i.a.createElement(Ht,{value:"2"},"数据订阅"),i.a.createElement(Ht,{value:"3"},"应用管理"),i.a.createElement(Ht,{value:"4"},"设备管理"),i.a.createElement(Ht,{value:"5"},"固件管理"),i.a.createElement(Ht,{value:"6"},"调试工具")))),i.a.createElement(m.a.Item,{label:"对象"},e("theme",{rules:[],initialValue:""})(i.a.createElement(h.a,{style:{width:"220px"},placeholder:"请输入操作对象"}))),i.a.createElement(m.a.Item,{label:"时间"},e("time",{rules:[]})(i.a.createElement(Jt,{style:{width:"220px"},disabledDate:this.disabledDate,format:"YYYY/MM/DD"})))),i.a.createElement("div",{className:"searchBut"},i.a.createElement(m.a.Item,null,i.a.createElement(f.a,{style:{marginRight:"12px"},htmlType:"submit",type:"primary"},"查询"),i.a.createElement(f.a,{onClick:this.reset,type:"default"},"重置"))))}}]),t}(),Zt=m.a.create({name:"search-form"})(zt),Yt=function(e){function t(e){var n;return Mt(this,t),(n=Bt(this,qt(t).call(this,e))).state={logsList:[],pager:{},pageIndex:1,conditions:{userName:"",type:"",theme:"",startTime:"",endTime:""}},n.searchLog=function(e){n.setState({conditions:e,pageIndex:1},function(){n.getLogsList()})},n.changePage=function(e){n.setState({pageIndex:e},function(){n.getLogsList()})},n.columns=[{title:"操作人",dataIndex:"userName",width:"250px"},{title:"操作",dataIndex:"content",width:"200px",render:function(e,t){var n=t.content,a=t.description;return i.a.createElement("span",null,a||n||"未识别内容")}},{title:"对象",dataIndex:"theme"},{title:"时间",width:"200px",dataIndex:"createTime",render:function(e,t){var n=t.createTime;return i.a.createElement("span",null,P.a.utcToDev(+n))}}],n}return Wt(t,o["Component"]),Ut(t,[{key:"componentDidMount",value:function(){this.getLogsList()}},{key:"getLogsList",value:function(){var e=this,t=this.state,n=t.conditions,a=t.pageIndex,r={};Object.keys(n).forEach(function(e){n[e]&&(r[e]=n[e])}),Object(l.c)(l.a.getOperateLogList,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tt(n,!0).forEach(function(t){Ft(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},r,{pageIndex:a,pageRows:20}),{loading:!0,needVersion:1.1}).then(function(t){var n=t.data||{},a=n.list,r=n.pager;e.setState({logsList:Object(P.c)(a),pager:r})})}},{key:"render",value:function(){var e=this,t=this.state,n=t.logsList,a=t.pager,r=t.pageIndex;return i.a.createElement("div",null,i.a.createElement("div",null,i.a.createElement(p.a,{noback:!0,title:"操作日志"})),i.a.createElement(d.a,{title:""},i.a.createElement("div",{className:"search-area lineSearchBox"},i.a.createElement(Zt,{searchLog:this.searchLog})),i.a.createElement("div",{style:{marginTop:"24px",padding:"12px 24px"}},i.a.createElement(H.a,{columns:this.columns,pagination:{total:a.totalRows,current:r,defaultCurrent:1,defaultPageSize:20,onChange:function(t){return e.changePage(t)},showTotal:function(e){return i.a.createElement("span",null,"共 ",i.a.createElement("a",null,e)," 条")},showQuickJumper:!0,hideOnSinglePage:!0},dataSource:n}))))}}]),t}(),Qt=n("w1Zx"),$t=n("7U7l");function Xt(e){return(Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function en(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function tn(e,t){return!t||"object"!==Xt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nn(e){return(nn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function an(e,t){return(an=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rn=[{title:"身份验证"},{title:"重置密码"},{title:"完成"}],on=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),tn(this,nn(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&an(e,t)}(t,o["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.props.developerInfo.email;return i.a.createElement($t.a,{FlowList:rn,cType:2,emailFromFather:e||"",isNeedVerifyType:!0,title:"重置密码"})}}])&&en(n.prototype,a),r&&en(n,r),t}();function cn(e){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ln(e,t){return!t||"object"!==cn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function un(e){return(un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pn(e,t){return(pn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dn=[{title:"身份验证"},{title:"设置电子邮箱"},{title:"完成"}],fn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ln(this,un(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pn(e,t)}(t,o["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.props.developerInfo.email;return i.a.createElement($t.a,{FlowList:dn,cType:3,emailFromFather:e,isNeedVerifyType:!0,title:"修改电子邮箱"})}}])&&sn(n.prototype,a),r&&sn(n,r),t}();function mn(e){return(mn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function yn(e,t){return!t||"object"!==mn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bn(e){return(bn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gn(e,t){return(gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vn=[{title:"身份验证"},{title:"提交注销申请"},{title:"审核"}],En=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yn(this,bn(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gn(e,t)}(t,o["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.props.developerInfo.email;return i.a.createElement($t.a,{FlowList:vn,cType:5,emailFromFather:e||"",isNeedVerifyType:!0,title:"注销账号"})}}])&&hn(n.prototype,a),r&&hn(n,r),t}(),On=n("g5u9"),kn=n("nyxj");function Sn(e){return(Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function jn(e,t){return!t||"object"!==Sn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _n(e){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function In(e,t){return(In=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),jn(this,_n(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&In(e,t)}(t,o["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.props.history;return i.a.createElement(On.a,{needHeader:!1,isInPage:!0},i.a.createElement("div",{className:"content-area"},i.a.createElement("div",{className:"title"},"重置登录密码"),i.a.createElement("div",{className:"desc default middle-fontsize"},"重置子账户登录密码，需要验证原登录账号"),i.a.createElement(kn.d,{history:e})))}}])&&wn(n.prototype,a),r&&wn(n,r),t}();n("0Zna");function Cn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(a=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ln(){return(Ln=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Nn(e){var t=e.developerInfo,n=e.getDeveloperInfo,a=e.match.path,r=!(1===t.isSubUser);return i.a.createElement(c.e,null,i.a.createElement(c.c,{path:"".concat(a,"/setting"),render:function(e){return i.a.createElement(Rn,Ln({},e,{developerInfo:t,getDeveloperInfo:n}))}}),i.a.createElement(Qt.a,{component:on,path:"".concat(a,"/resetPassword"),redirect:"".concat(a,"/base"),developerInfo:t,isOk:r}),i.a.createElement(Qt.a,{component:fn,path:"".concat(a,"/updateEmail"),redirect:"".concat(a,"/base"),developerInfo:t,isOk:r}),i.a.createElement(Qt.a,{component:En,path:"".concat(a,"/closeAccount"),redirect:"".concat(a,"/base"),developerInfo:t,isOk:r}),i.a.createElement(Qt.a,{component:xn,path:"".concat(a,"/subResetPassword"),redirect:"".concat(a,"/base"),isOk:!r}),i.a.createElement(c.b,{to:"".concat(a,"/setting")}))}function Rn(e){var t=e.developerInfo,n=e.history,a=e.getDeveloperInfo,r=t.id,c=t.secretId,s=t.secretKey,u=t.createTime,f=t.isSubUser,m=t.email,h=t.cancelStatus,y=!!f,b=Cn(Object(o.useState)(!1),2),g=b[0],v=b[1],E=Cn(Object(o.useState)(!1),2),O=E[0],k=E[1],S=function(e){n.push({pathname:"/userCenter/security/".concat(e)})};return i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{noback:!0,title:"安全设置"}),i.a.createElement(d.a,null,i.a.createElement("div",{className:"safe-setting"},i.a.createElement("div",{className:"setting-item flex-row"},i.a.createElement("div",{className:"left-desc flex1"},i.a.createElement("div",{className:"title"},"API访问秘钥"),i.a.createElement("div",{className:"desc-content"},i.a.createElement("div",{className:"p-flex"},i.a.createElement("span",{className:"flex-item"},i.a.createElement("span",{className:"tit"},"开发者ID："),r),i.a.createElement("span",{className:"flex-item"},i.a.createElement("span",{className:"tit"},"用户secretId："),g?c:Object(P.r)(c,10),i.a.createElement(Me.a,{type:g?"eye":"eye-invisible",style:{fontSize:"18px",marginLeft:"6px"},theme:"twoTone",twoToneColor:"#2874FF",onClick:function(){v(function(e){return!e})}})),i.a.createElement("span",{className:"flex-item"},i.a.createElement("span",{className:"tit"},"用户SecretKey："),O?s:Object(P.r)(s,10),i.a.createElement(Me.a,{type:O?"eye":"eye-invisible",style:{fontSize:"18px",marginLeft:"6px"},theme:"twoTone",twoToneColor:"#2874FF",onClick:function(){k(function(e){return!e})}})),i.a.createElement("span",{className:"flex-item"},i.a.createElement("span",{className:"tit"},"创建时间："),u?P.a.utcToDev(u):"--"))))),i.a.createElement("div",{className:"setting-item flex-row"},i.a.createElement("div",{className:"left-desc flex1"},i.a.createElement("div",{className:"title"},"登录密码"),i.a.createElement("div",{className:"desc-content"},"登录平台需验证密码。以字母开头的6到18位的字母，数字和下划线。建议您定期更换密码。")),i.a.createElement("div",{className:"setting-btn-wrapper"},i.a.createElement("div",{className:"btns"},i.a.createElement("span",{className:"btn-has"},"已设置"),i.a.createElement("span",{onClick:function(){return S(y?"subResetPassword":"resetPassword")},className:"btn-can-control"},"重置")))),!y&&i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"setting-item flex-row"},i.a.createElement("div",{className:"left-desc flex1"},i.a.createElement("div",{className:"title"},"电子邮箱"),i.a.createElement("div",{className:"desc-content"},"电子邮箱地址可用于登录平台，也可以用于接收服务通知信息。")),i.a.createElement("div",{className:"setting-btn-wrapper"},i.a.createElement("div",{className:"btns"},i.a.createElement("span",{className:m?"btn-has":"btn-not-has"},m?"已设置":"未设置"),i.a.createElement("span",{onClick:function(){return S("updateEmail")},className:"btn-can-control"},"重置")))),i.a.createElement("div",{className:"setting-item flex-row"},i.a.createElement("div",{className:"left-desc flex1"},i.a.createElement("div",{className:"title"},"注销账户"),i.a.createElement("div",{className:"desc-content"},"如果您不再使用此账号，可以将其注销。账号成功注销后，所有的产品数据及隐私信息将会被永久删除且无法恢复。")),i.a.createElement("div",{className:"setting-btn-wrapper"},i.a.createElement("div",{className:"btns"},1==h?i.a.createElement("span",{onClick:function(){Object(l.c)(l.a.withdraw,{},{loading:!0}).then(function(e){a()}).catch(function(e){})},className:"btn-can-control"},"撤销注销账户申请"):i.a.createElement("span",{onClick:function(){return S("closeAccount")},className:"btn-can-control"},"注销账户"))))))))}n("sMBO"),n("Eh1p");function Pn(e){return(Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dn(){return(Dn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Tn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Fn(e,t){return!t||"object"!==Pn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function An(e){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vn(e,t){return(Vn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mn=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Fn(this,An(t).call(this,e))).affirm=function(){(0,n.props.form.validateFieldsAndScroll)(function(e,t){e||Object(l.d)(l.a.addCase,t).then(function(e){0==e.code&&(Object(X.a)({type:"success",description:"实例创建成功！"}),n.props.form.resetFields(),n.props.onAddClose(),n.props.pagerIndex(1))})})},n.blurr=function(e){var t=n.props.form,a=t.getFieldValue,r=t.setFieldsValue,o=a(e);if(""==o||0==o){var i={};i[e]={namespaceCpu:20,namespaceMemory:10,namespaceStorage:100}[e],r(i)}},n.state={},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vn(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"render",value:function(){var e=this.props.form,t=e.getFieldDecorator,n=e.getFieldValue;return i.a.createElement(m.a,Dn({},{labelCol:{span:4},wrapperCol:{span:20}},{onSubmit:this.handleSubmit}),i.a.createElement(m.a.Item,{label:"实例名称"},t("name",{rules:[{required:!0,message:"请输入实例名称"},{max:20,message:"最大输入长度为20"}]})(i.a.createElement(h.a,{placeholder:"请输入实例名称"}))),i.a.createElement(We.a,{label:"备注",formId:"desc",astrictNub:"50",rows:"3",isRequired:!0,placeholder:"实例备注",getFieldDecorator:t,getFieldValue:n}),i.a.createElement(m.a.Item,{label:"cpu(核)"},t("namespaceCpu",{rules:[{max:3,required:!0,pattern:/^\d{1,3}$/,message:"请输入不超过3位数的数字"}],initialValue:20})(i.a.createElement(h.a,{placeholder:"请输入申请核数（核）/默认20核",onBlur:this.blurr.bind(this,"namespaceCpu")}))),i.a.createElement(m.a.Item,{label:"内存(G)"},t("namespaceMemory",{rules:[{max:3,required:!0,pattern:/^\d{1,3}$/,message:"请输入不超过3位数的数字"}],initialValue:10})(i.a.createElement(h.a,{placeholder:"请输入申请内存（G）/默认10G",onBlur:this.blurr.bind(this,"namespaceMemory")}))),i.a.createElement(m.a.Item,{label:"存储(G)"},t("namespaceStorage",{rules:[{max:4,required:!0,pattern:/^\d{1,4}$/,message:"请输入不超过4位数的数字"}],initialValue:100})(i.a.createElement(h.a,{placeholder:"请输入申请存储空间（G）/默认100G",onBlur:this.blurr.bind(this,"namespaceStorage")}))))}}])&&Tn(n.prototype,a),r&&Tn(n,r),t}(),Kn=m.a.create({name:"caseAdd"})(Mn);function Un(e){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bn(){return(Bn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function qn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Wn(e,t){return!t||"object"!==Un(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gn(e){return(Gn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jn(e,t){return(Jn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Hn=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Wn(this,Gn(t).call(this,e))).state={},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jn(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"render",value:function(){var e=this.props.form,t=e.getFieldDecorator;e.getFieldValue;return i.a.createElement(m.a,Bn({},{labelCol:{span:4},wrapperCol:{span:20}},{onSubmit:this.handleSubmit}),i.a.createElement(m.a.Item,{label:"cpu(核)"},t("namespaceCpu",{rules:[{required:!0,message:"请输入cpu"},{max:3,message:"最大输入长度为3"}]})(i.a.createElement(h.a,{placeholder:"输入申请核数(核)"}))),i.a.createElement(m.a.Item,{label:"内存(G)"},t("namespaceMemory",{rules:[{required:!0,message:"请输入内存"},{max:3,message:"最大输入长度为3"}]})(i.a.createElement(h.a,{placeholder:"输入申请内存"}))),i.a.createElement(m.a.Item,{label:"存储(G)"},t("namespaceStorage",{rules:[{required:!0,message:"请输入存储"},{max:4,message:"最大输入长度为4"}]})(i.a.createElement(h.a,{placeholder:"输入申请存储空间"}))))}}])&&qn(n.prototype,a),r&&qn(n,r),t}(),zn=m.a.create({name:"applyFor"})(Hn);function Zn(e){return(Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yn(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Qn(e){return(Qn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xn(e,t){return(Xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ea=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Qn(t).call(this,e),(n=!r||"object"!==Zn(r)&&"function"!=typeof r?$n(a):r).getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(l.c)(l.a.getCasePageList,e).then(function(e){n.setState({caseList:e.data.list,pager:e.data.pager,loading:!1})})},n.addCase=function(){n.setState({addCaseVisible:!0})},n.searchCase=function(e){n.setState({loading:!0,searchName:e},function(){n.pagerIndex(1)})},n.startOrForbidden=function(e,t,a){n.setState({updatetype:e,name:t,id:a})},n.startOrForbiddenModal=function(e){if("ok"==e){var t=n.state,a=t.id,r=t.pageIndex,o=t.updatetype;r=r||1,Object(l.d)(l.a.updateCaseStatus,{status:o,id:a}).then(function(e){0==e.code&&n.setState({loading:!0},function(){n.getList({pageIndex:r,pageRows:10})})})}n.setState({updatetype:2})},n.addUserModal=function(e){1==e?n.addUserRefs.affirm():(n.closeAdd(),n.addUserRefs.props.form.resetFields())},n.closeAdd=function(){n.setState({addCaseVisible:!1})},n.pagerIndex=function(e){n.setState({pageIndex:e,loading:!0},function(){n.getList({pageIndex:e,pageRows:10,name:n.state.searchName||void 0})})},n.openApplySource=function(e){console.log("--id--",e),-1!=e?n.setState({applyForVisible:!0,id:e}):(n.setState({applyForVisible:!1}),n.applyForRefs.props.form.resetFields())},n.applyOk=function(){var e=n.applyForRefs.props.form,t=n.state.id;(0,e.validateFieldsAndScroll)(function(e,a){var r=a.namespaceCpu,o=a.namespaceMemory,i=a.namespaceStorage;e||Object(l.d)(l.a.applySource,{namespaceCpu:r,namespaceMemory:o,namespaceStorage:i,id:t}).then(function(e){0==e.code&&(Object(X.a)({type:"success",description:"资源申请成功！"}),n.openApplySource(-1),n.pagerIndex(1))})})},n.state={loading:!0,caseList:[],pager:{},searchName:"",name:"",id:"",addCaseVisible:!1,updatetype:2,pageIndex:"1",applyForVisible:!1},n.columns=[{title:"实例名称",dataIndex:"name",key:"name",render:function(e){return i.a.createElement(Fe.a,{placement:"topLeft",title:e},i.a.createElement("span",null,e))}},{title:"实例状态",dataIndex:"status",key:"status",width:"100px",render:function(e,t){var n={0:"可用",1:"不可用"}[t.status];return i.a.createElement(Fe.a,{placement:"topLeft",title:n}," ",i.a.createElement("span",null,n)," ")}},{title:"备注",dataIndex:"desc",key:"desc",render:function(e){return i.a.createElement(Fe.a,{placement:"topLeft",title:e}," ",i.a.createElement("span",null,e)," ")}},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:"160px",render:function(e){return i.a.createElement("span",null,$()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss"))}},{title:"创建人",dataIndex:"createUser",key:"createUser",render:function(e){return i.a.createElement(Fe.a,{placement:"topLeft",title:e},i.a.createElement("span",null,e))}},{title:"可用资源",dataIndex:"availableRes",key:"availableRes",render:function(e){return i.a.createElement(Fe.a,{placement:"topLeft",title:e},i.a.createElement("span",null,e))}},{title:"操作",key:"action",width:"140px",render:function(e,t){var a=t.id,r=t.name,o=t.status,c=t.type;return i.a.createElement("span",null,i.a.createElement("a",{onClick:n.openApplySource.bind($n(n),a)},"资源申请"),0!==c&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Z.a,{type:"vertical"}),0==o?i.a.createElement("a",{onClick:n.startOrForbidden.bind($n(n),1,r,a),style:{color:"#FF3100"}},"停用"):i.a.createElement("a",{onClick:n.startOrForbidden.bind($n(n),0,r,a)},"启用")))}}],n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xn(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this.getList({pageIndex:1,pageRows:10})}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.name,r=t.addCaseVisible,o=t.updatetype,c=t.caseList,s=t.pager,l=t.applyForVisible,u=2!=o,p="";return u&&(p=0==o?"启用":"停用"),i.a.createElement("div",{className:"user-visit-box"},i.a.createElement("header",{className:"page-content-header"},i.a.createElement("h3",{className:"page-name"},"实例管理"),i.a.createElement("div",null,i.a.createElement("div",{className:"searchBox"},i.a.createElement(h.a.Search,{placeholder:"请输入实例名查找",enterButton:!0,maxLength:20,onSearch:function(t){return e.searchCase(t)}})),i.a.createElement("div",{className:"butFloatRight"},i.a.createElement(f.a,{className:"but-add",type:"primary",onClick:this.addCase},"新增实例")))),i.a.createElement("div",{className:"commonContentBox"},i.a.createElement("div",{className:"centent"},i.a.createElement(H.a,{rowKey:"id",columns:this.columns,dataSource:c,pagination:{defaultCurrent:s.pageIndex,total:s.totalRows,hideOnSinglePage:!1,onChange:this.pagerIndex,current:s.pageIndex},loading:n}))),i.a.createElement(Te.a,{title:"新增实例",visible:r,width:800,onOk:this.addUserModal.bind(this,1),onCancel:this.addUserModal.bind(this,2),maskClosable:!1},i.a.createElement(Kn,{onRef:function(t){return e.addUserRefs=t},onAddClose:this.closeAdd,pagerIndex:this.pagerIndex})),i.a.createElement(Te.a,{title:"资源申请",visible:l,width:500,onOk:this.applyOk,onCancel:this.openApplySource.bind(this,-1),maskClosable:!1},i.a.createElement(zn,{onRef:function(t){return e.applyForRefs=t}})),i.a.createElement(Ae.a,{visible:u,modalOKHandle:this.startOrForbiddenModal.bind(this,"ok"),modalCancelHandle:this.startOrForbiddenModal.bind(this,"cancel"),title:"".concat(p,"实例"),descText:"即将".concat(p,"实例"),targetName:a,needWarnIcon:1==o}))}}])&&Yn(n.prototype,a),r&&Yn(n,r),t}(),ta=(n("gySj"),n("DFOY"));n("wA0d");function na(e){return(na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aa(){return(aa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ra(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function oa(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ia(e,t){return!t||"object"!==na(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ca(e){return(ca=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sa(e,t){return(sa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var la=b.a.Option,ua=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ia(this,ca(t).call(this,e))).onChangeAuthType=function(e){n.setState({authType:e.target.value})},n.loadData=function(e){var t=e[0];t.loading=!0,Object(l.c)(l.a.getDataAssetsListAuth,{pageRows:999,type:t.value}).then(function(e){t.loading=!1;var a=e.data.list||[];t.children=a.map(function(e){return{label:e.name,value:e.id}}),n.setState({dataAsset:ra(n.state.dataAsset)})})},n.cngSearchType=function(e){n.setState({searchType:e})},n.searchInstance=function(e){var t=n.state.searchType;e&&Object(l.c)(l.a.getAuthList,{type:t,param:e,pageRows:999}).then(function(e){if(0==e.code){var t=e.data&&e.data.list||[];n.setState({dataInstanceList:t,searched:!0})}})},n.getInstanceOptions=function(){return n.state.dataInstanceList.map(function(e){var t=e.instanceVos.map(function(e){return{value:e.id,label:e.name||"--"}});return{value:"".concat(e.developerId,",").concat(e.account),label:e.account||"--",children:t}})},n.state={authType:0,searchType:0,productList:[],deviceGroupList:[],dataAsset:[{value:1,label:"mqtt",isLeaf:!1},{value:2,label:"mysql数据库",isLeaf:!1},{value:4,label:"redis",isLeaf:!1},{value:5,label:"rocketMq",isLeaf:!1}],dataInstanceList:[],searched:!1,apiList:[]},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sa(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){var e=this;this.props.onRef(this),Object(l.c)(l.a.getCreateProduct,{pageRows:999}).then(function(t){var n=t.data.list||[];e.setState({productList:n})}),Object(l.c)(l.a.getGroupListAuth,{pageRows:999}).then(function(t){var n=t.data.list||[];e.setState({deviceGroupList:n})}),Object(l.c)(l.a.getAuthorServeList,{pageRows:999,proEnv:2}).then(function(t){var n=(t&&t.data||{list:[]}).list;e.setState({apiList:n})})}},{key:"render",value:function(){var e=this.state,t=e.authType,n=e.dataAsset,a=e.productList,r=e.deviceGroupList,o=e.apiList,c=e.searched,s=this.props.form.getFieldDecorator,l={0:i.a.createElement(b.a,{showSearch:!0,placeholder:"选择产品",optionFilterProp:"children"},a.map(function(e,t){return i.a.createElement(la,{key:t,value:e.productId},e.productName)})),1:i.a.createElement(b.a,{showSearch:!0,placeholder:"选择设备组",optionFilterProp:"children"},r.map(function(e,t){return i.a.createElement(la,{key:t,value:e.id},e.name)})),2:i.a.createElement(ta.a,{options:n,loadData:this.loadData,placeholder:"请选择数据资产源"}),3:i.a.createElement(b.a,{showSearch:!0,placeholder:"选择API",optionFilterProp:"children"},o.map(function(e,t){return i.a.createElement(la,{key:t,value:e.id},e.name)}))}[t];return i.a.createElement(m.a,aa({},{labelCol:{span:5},wrapperCol:{span:18}},{onSubmit:this.handleSubmit}),i.a.createElement(m.a.Item,{label:"授权对象类型"},s("authType",{rules:[{required:!0,message:"请选择授权对象类型"}],initialValue:0})(i.a.createElement(ie.a.Group,{onChange:this.onChangeAuthType},i.a.createElement(ie.a,{value:0},"产品"),i.a.createElement(ie.a,{value:1},"设备分组"),i.a.createElement(ie.a,{value:2},"数据资产源"),i.a.createElement(ie.a,{value:3},"API权限调用")))),i.a.createElement(m.a.Item,{label:"授权对象"},s({0:"proid",1:"groupid",2:"toobjid",3:"apiid"}[t],{rules:[{required:!0,message:"请选择授权对象"}]})(l)),i.a.createElement(m.a.Item,{label:"被授权主体"},s("authorizedType",{rules:[{required:!0,message:"请选择被授权主体类型"}],initialValue:0})(i.a.createElement(ie.a.Group,null,i.a.createElement(ie.a,{value:0},"实例")))),i.a.createElement("div",{className:"searchlistbox"},i.a.createElement(h.a.Group,{compact:!0,className:"searchbox"},i.a.createElement(b.a,{style:{width:"25%"},defaultValue:0,onChange:this.cngSearchType},i.a.createElement(la,{value:0},"账户名"),i.a.createElement(la,{value:1},"产品名")),i.a.createElement(h.a.Search,{style:{width:"75%"},placeholder:"输入查询关键字",onSearch:this.searchInstance})),i.a.createElement(m.a.Item,{label:""},s("instanceObj",{rules:[{required:!0,message:"请选择被授权实例"}]})(i.a.createElement(ta.a,{style:{width:"450px"},options:this.getInstanceOptions(),expandTrigger:"hover",placeholder:c?"选择实例":"请先在搜索框输入关键字查询",disabled:!c})))),i.a.createElement(m.a.Item,{label:"授权策略"},s("authPolicy",{rules:[{required:!0,message:"请选择授权策略"}],initialValue:0})(i.a.createElement(ie.a.Group,null,i.a.createElement(ie.a,{value:0},"默认策略")))))}}])&&oa(n.prototype,a),r&&oa(n,r),t}(),pa=m.a.create({name:"caseAdd"})(ua),da=(n("oVuX"),n("MKzF"),n("kaz8"));function fa(e){return(fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ma(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ha(e,t){return!t||"object"!==fa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ya(e){return(ya=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ba(e,t){return(ba=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ga=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ha(this,ya(t).call(this,e))).onChange=function(e){n.setState({checkedValues:e})},n.cancelCommit=function(){var e=n.props.cancelData,t=e.id,a=e.instanceIds;if(a.indexOf(",")>-1){var r=n.state.checkedValues;if(0==r.length)return void Object(X.a)({type:"warn",description:"请至少选中一项"});a=r.join(",")}Object(l.d)(l.a.deleAuthorize,{id:t,instanceId:a}).then(function(e){0==e.code&&n.props.cancelSucess()})},n.getOptions=function(){var e=n.props.cancelData,t=e.instanceIds,a=void 0===t?"":t,r=e.instanceName,o=void 0===r?"":r,i=a.split(",");return o.split(",").map(function(e,t){return{label:e,value:i[t]}})},n.state={checkedValues:[]},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ba(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"render",value:function(){var e=this.getOptions();return e.length>1?i.a.createElement(da.a.Group,{options:e,onChange:this.onChange}):i.a.createElement("span",null,e[0].label||"确定取消该条授权？")}}])&&ma(n.prototype,a),r&&ma(n,r),t}();function va(e){return(va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ea(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Oa(e){return(Oa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ka(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sa(e,t){return(Sa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wa=b.a.Option,ja=["产品","设备分组","数据资产源","API权限调用"],_a=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Oa(t).call(this,e),(n=!r||"object"!==va(r)&&"function"!=typeof r?ka(a):r).cancelModVisiable=function(e){n.setState({cancelData:e})},n.getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(l.c)(l.a.getAuthorizeList,e).then(function(e){n.setState({caseList:e.data.list,pager:e.data.pager,loading:!1})})},n.addCase=function(){n.setState({addCaseVisible:!0})},n.searchCase=function(e){n.setState({loading:!0,searchName:e},function(){n.pagerIndex(1)})},n.pagerIndex=function(e){var t=n.state,a=t.searchName,r=t.authType;n.setState({pageIndex:e,loading:!0},function(){n.getList({pageIndex:e,pageRows:10,authType:r,param:a||void 0})})},n.deleAuthOk=function(){n.cancelAuthRefs.cancelCommit()},n.cancelSucess=function(){n.cancelModVisiable(!1),n.pagerIndex(n.state.pageIndex)},n.addOk=function(){var e=n.addFormRefs.props.form;n.state.id;(0,e.validateFieldsAndScroll)(function(e,t){var a=t.authType,r=t.authorizedType,o=t.authPolicy,i=t.instanceObj,c=t.proid,s=t.groupid,u=t.toobjid,p=t.apiid,d=i[1],f=i[0].split(","),m=f[1],h=f[0],y=c||s||p||u[1];e||Object(l.d)(l.a.addAuthorize,{productId:y,authType:a,authorizedType:r,authPolicy:o,instanceId:d,receiverEmail:m,receiverId:h}).then(function(e){0==e.code&&(Object(X.a)({type:"success",description:"新增成功！"}),n.addCancel(),n.pagerIndex(1))})})},n.addCancel=function(){n.setState({addCaseVisible:!1}),n.addFormRefs.props.form.resetFields(),n.addFormRefs.setState({authType:0})},n.cngSearchType=function(e){n.setState({loading:!0,authType:e},function(){n.pagerIndex(1)})},n.state={loading:!0,caseList:[],pager:{},searchName:"",name:"",id:"",addCaseVisible:!1,cancelVisible:!1,pageIndex:"1",cancelData:!1,authType:0},n.columns=[{title:"授权对象名称",dataIndex:"name",key:"name"},{title:"授权对象类型",dataIndex:"authType",key:"authType",render:function(e){return i.a.createElement("span",null,ja[e])}},{title:"被授权人",dataIndex:"receiver",key:"receiver"},{title:"被授权主体",dataIndex:"instanceName",key:"instanceName",render:function(e){var t=e.split(",");return t.map(function(e,n){return i.a.createElement("span",{key:n},e,n<t.length-1?"、":"",i.a.createElement("br",null))})}},{title:"被授权主体类型",dataIndex:"authorizedType",key:"authorizedType",render:function(e){return i.a.createElement("span",null,{0:"实例"}[e])}},{title:"授权策略",dataIndex:"authPolicy",key:"authPolicy",render:function(e){return i.a.createElement("span",null,{0:"默认策略"}[e])}},{title:"授权时间",dataIndex:"createTime",key:"createTime",width:"160px",render:function(e){return i.a.createElement("span",null,P.a.utcToDev(e))}},{title:"操作",key:"action",width:"160px",render:function(e,t){return i.a.createElement("a",{onClick:n.cancelModVisiable.bind(ka(n),t),style:{color:"#FF3100"}},"取消授权")}}],n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sa(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this.pagerIndex(1)}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=(t.name,t.addCaseVisible),r=(t.cancelVisible,t.caseList),o=t.pager,c=t.cancelData;return i.a.createElement("div",{className:"authorize-page"},i.a.createElement("header",{className:"page-content-header"},i.a.createElement("h3",{className:"page-name"},"授权管理"),i.a.createElement("div",null,i.a.createElement(h.a.Group,{compact:!0,className:"searchgroupbox"},i.a.createElement(b.a,{style:{width:"30%"},defaultValue:0,onChange:this.cngSearchType},ja.map(function(e,t){return i.a.createElement(wa,{key:t,value:t},e)})),i.a.createElement(h.a.Search,{style:{width:"70%"},placeholder:"请输入授权对象名查找",enterButton:!0,maxLength:20,onSearch:function(t){return e.searchCase(t)}})),i.a.createElement("div",{className:"butFloatRight"},i.a.createElement(f.a,{className:"but-add",type:"primary",onClick:this.addCase},"新增授权")))),i.a.createElement("div",{className:"commonContentBox"},i.a.createElement("div",{className:"centent"},i.a.createElement(H.a,{rowKey:"id",columns:this.columns,dataSource:r,pagination:{defaultCurrent:o.pageIndex,total:o.totalRows,hideOnSinglePage:!1,onChange:this.pagerIndex,current:o.pageIndex},loading:n}))),i.a.createElement(Te.a,{title:"新增授权",visible:a,width:650,onOk:this.addOk,onCancel:this.addCancel,maskClosable:!1},i.a.createElement(pa,{onRef:function(t){return e.addFormRefs=t}})),i.a.createElement(Te.a,{title:"取消授权",visible:!!c,width:400,onOk:this.deleAuthOk,onCancel:this.cancelModVisiable.bind(this,!1),maskClosable:!1},i.a.createElement(ga,{onRef:function(t){return e.cancelAuthRefs=t},cancelData:c,cancelSucess:this.cancelSucess})))}}])&&Ea(n.prototype,a),r&&Ea(n,r),t}(),Ia=n("55Ip");n("a5gO");function xa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(a=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Ca=b.a.Option,La={0:"否",1:"是"},Na={string:"字符串",number:"数字"};var Ra=Object(o.memo)(Object(o.forwardRef)(function(e,t){var n=e.list,a=void 0===n?[]:n,r=xa(Object(o.useState)(a),2),c=r[0],s=r[1],l=xa(Object(o.useState)(-1),2),u=l[0],p=l[1];Object(o.useImperativeHandle)(t,function(){return{sourcelist:c}},[c]);var d=function(){s(function(e){var t=e.map(function(e){return e});return t.push({name:"",type:"string",must:"0",defaultVal:"",desc:""}),t})},f=function(e,t){s(function(n){return n.map(function(n,a){var r=Object.assign({},n);return r[e]=t,a==u?r:n})})};return i.a.createElement("div",{className:"paramtable"},c.length>0&&i.a.createElement("table",{className:"labeltable",onMouseLeave:function(){p(-1)}},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{style:{width:"20%"}},"参数名"),i.a.createElement("th",{style:{width:"15%"}},"类型"),i.a.createElement("th",{style:{width:"15%"}},"是否必选"),i.a.createElement("th",{style:{width:"18%"}},"默认值"),i.a.createElement("th",{style:{width:"26%"}},"描述"),i.a.createElement("th",{style:{width:"6%",cursor:"pointer"},title:"添加参数"},i.a.createElement("a",{onClick:d,href:"javascript:"},i.a.createElement(Me.a,{type:"plus"}))))),i.a.createElement("tbody",null,c.map(function(e,t){var n=e.name,a=e.type,r=e.must,o=e.defaultVal,c=e.desc;if(u==t){var l=[];for(var d in Na)l.push(i.a.createElement(Ca,{key:d,value:d},Na[d]));return i.a.createElement("tr",{key:"tr_"+t},i.a.createElement("td",null,i.a.createElement(h.a,{value:n,onChange:function(e){f("name",e.target.value)}})),i.a.createElement("td",null,i.a.createElement(b.a,{value:a,onChange:function(e){f("type",e)}},l)),i.a.createElement("td",null,i.a.createElement(b.a,{value:r,onChange:function(e){f("must",e)}},i.a.createElement(Ca,{value:"0"},"否"),i.a.createElement(Ca,{value:"1"},"是"))),i.a.createElement("td",null,i.a.createElement(h.a,{value:o,onChange:function(e){f("defaultVal",e.target.value)}})),i.a.createElement("td",null,i.a.createElement(h.a,{value:c,placeholder:"描述",onChange:function(e){f("desc",e.target.value)}})),i.a.createElement("td",null,i.a.createElement("a",{onClick:function(){!function(e){s(function(t){var n=t.map(function(e){return e});return n.splice(e,1),n})}(t)},href:"javascript:"}," ",i.a.createElement(Me.a,{type:"minus"})," ")))}return i.a.createElement("tr",{key:"tr_"+t,onClick:function(){p(t)}},i.a.createElement("td",null,n),i.a.createElement("td",null,Na[a]),i.a.createElement("td",null,La[r]),i.a.createElement("td",null,o),i.a.createElement("td",null,c))})))||i.a.createElement("div",{className:"tempdatabox"}," 暂无参数，",i.a.createElement("a",{onClick:d,href:"javascript:"},"点击添加")," "))}));function Pa(e){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Da(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ta(e){return(Ta=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Aa(e,t){return(Aa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Va=b.a.Option,Ma=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=Ta(t).call(this,e),(n=!r||"object"!==Pa(r)&&"function"!=typeof r?Fa(a):r).getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(l.c)(l.a.getDataAssetsList,e).then(function(e){n.setState({caseList:e.data.list,pager:e.data.pager,loading:!1})})},n.cngSearchType=function(e){n.setState({searchType:e})},n.cngSearchName=function(e){n.setState({searchName:e.target.value})},n.searchCase=function(e){n.setState({searchName:e},function(){n.pagerIndex(1)})},n.resetList=function(){n.setState({searchName:"",searchType:void 0},function(){n.getList({pageIndex:1,pageRows:10})})},n.openDel=function(e,t){n.setState({name:t,id:e})},n.delOkCancel=function(e){if("ok"==e){var t=n.state,a=t.id,r=t.pageIndex;r=r||1,Object(l.c)(l.a.delDataAssets,{id:a}).then(function(e){0==e.code&&n.setState({loading:!0,id:""},function(){n.getList({pageIndex:r,pageRows:10})})})}else n.setState({id:""})},n.pagerIndex=function(e){n.setState({pageIndex:e,loading:!0},function(){var t=n.state,a=t.searchName,r=t.searchType;n.getList({pageIndex:e,pageRows:10,name:a||void 0,type:r||void 0})})},n.state={loading:!0,caseList:[],pager:{},searchName:"",searchType:void 0,name:"",id:"",pageIndex:"1",typeList:[{id:1,name:"mqtt"},{id:2,name:"mysql数据库"},{id:3,name:"http服务"},{id:4,name:"redis"},{id:5,name:"rocketMq"}]},n.columns=[{title:"数据资产源名称",dataIndex:"name",key:"name"},{title:"描述",dataIndex:"remark",key:"remark",render:function(e,t){return i.a.createElement(Fe.a,{placement:"topLeft",title:e}," ",i.a.createElement("span",null,e)," ")}},{title:"类型",dataIndex:"type",key:"type",render:function(e){return n.state.typeList[e-1].name||"--"}},{title:"状态",dataIndex:"status",key:"status",render:function(e){return 0==e?"有效":"无效"}},{title:"创建时间",dataIndex:"createTime",key:"createTime",render:function(e){return i.a.createElement("span",null,P.a.utcToDev(e))}},{title:"操作",key:"action",width:"160px",render:function(e,t){var a=t.id,r=t.name;return i.a.createElement("span",null,i.a.createElement(Ia.b,{key:"detail",to:"/userCenter/assetdetail/".concat(a,"/1")},"查看"),i.a.createElement(Z.a,{type:"vertical"}),i.a.createElement(Ia.b,{key:"edit",to:"/userCenter/assetdetail/".concat(a,"/0")},"编辑"),i.a.createElement(Z.a,{type:"vertical"}),i.a.createElement("a",{onClick:n.openDel.bind(Fa(n),a,r)},"删除"))}}],n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aa(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this.getList({pageIndex:1,pageRows:10})}},{key:"render",value:function(){var e=this,t=this.state,n=t.loading,a=t.name,r=t.caseList,o=t.pager,c=t.typeList,s=t.searchType,l=t.searchName,u=t.id;return i.a.createElement("div",{className:"user-visit-box"},i.a.createElement("header",{className:"page-content-header butonlyheader"},i.a.createElement("h3",{className:"page-name"},"数据资产知识库管理"),i.a.createElement("div",{className:"butonly"},i.a.createElement(f.a,{className:"but-add",type:"primary",href:"#/userCenter/assetdetail/0/0"},"新增数据资产源"))),i.a.createElement(d.a,{title:"数据资产列表"},i.a.createElement("div",{className:"alone-section-content-default"},i.a.createElement("div",{className:"searchBox"},i.a.createElement("div",{className:"searchCriteria"},i.a.createElement(b.a,{className:"sele",placeholder:"请选择数据资产源类型",onChange:this.cngSearchType,value:s},c.map(function(e){return i.a.createElement(Va,{key:e.id,value:e.id},e.name)})),i.a.createElement(h.a.Search,{placeholder:"请输入数据资产源名称",value:l,onChange:this.cngSearchName,enterButton:!0,maxLength:20,onSearch:function(t){return e.searchCase(t)}}),i.a.createElement(f.a,{className:"btn",onClick:this.resetList},"重置"))),i.a.createElement("div",{className:"centent"},i.a.createElement(H.a,{rowKey:"id",columns:this.columns,dataSource:r,pagination:{defaultCurrent:o.pageIndex,total:o.totalRows,hideOnSinglePage:!1,onChange:this.pagerIndex,current:o.pageIndex},loading:n})))),i.a.createElement(Ae.a,{visible:!!u,modalOKHandle:this.delOkCancel.bind(this,"ok"),modalCancelHandle:this.delOkCancel.bind(this,"cancel"),title:"删除",descText:"即将删除数据资产源",targetName:a}))}}])&&Da(n.prototype,a),r&&Da(n,r),t}();n("+2oP");function Ka(e){return(Ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ua(){return(Ua=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Ba(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function qa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wa(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ga(e,t){return!t||"object"!==Ka(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ja(e){return(Ja=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ha(e,t){return(Ha=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var za,Za=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ga(this,Ja(t).call(this,e))).getTypeList=function(){var e=[{id:1,name:"mqtt"},{id:2,name:"mysql数据库"},{id:4,name:"redis"},{id:5,name:"rocketMq"}];return"het-developer"===n.props.developerInfo.account&&e.push({id:3,name:"http服务"}),e},n.getFormParDom=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=n.props.form.getFieldDecorator,a=n.state.assetType,r=Object.assign({},n.param[a+""]),o=[],c=function(c){var s=r[c].split("_"),l=s[0],u="".concat(c,"_").concat(e),p=s[1]||s[0],d=i.a.createElement(m.a.Item,{label:l,key:u},t(u,{rules:[{required:n.configIsRequired(a,c),message:"请输入".concat(l)},{max:100,message:"最大输入长度为100"}]})(i.a.createElement(h.a,{placeholder:p,disabled:1==a&&0==e,onChange:function(t){1==a&&1==e&&n.changeMqtt(t.target.value,"".concat(c,"_0"))}})));o.push(d)};for(var s in r)c(s);return o},n.changeMqtt=function(e,t){var a=qa({},t,e);n.props.form.setFieldsValue(a)},n.configIsRequired=function(e,t){return(4!=e||"pwd"!=t)&&(5!=e||"tags"!=t)},n.changeType=function(e){n.setState({assetType:e})},n.handleSubmit=function(e){e.preventDefault(),(0,n.props.form.validateFieldsAndScroll)(function(e,t){if(!e){var a=t.name,r=t.remark,o=t.type,i=t.projectId,c={name:a,remark:r,type:o,dataJson:n.getJsonStr(t),projectId:i&&i.join(",")},s=l.a.addDataAssets,u=n.props.match.params.id;0!=u&&(s=l.a.updateDataAssets,c.id=u),Object(l.d)(s,c).then(function(e){0==e.code&&(window.location.hash="/userCenter/dataasset")})}})},n.filterParams=function(e){var t=[];return e.forEach(function(e){e.name&&t.push(e)}),t},n.getJsonStr=function(e,t){var a={},r={},o={},i=Object.assign({},e);if(3==n.state.assetType){var c=n.ref1.current.sourcelist,s=n.filterParams(c);i.param_0=s,i.param_1=s}for(var l in i)l.indexOf("_0")>-1&&(r[l.slice(0,-2)]=i[l]),l.indexOf("_1")>-1&&(o[l.slice(0,-2)]=i[l]);return 0!=t&&(a[1]=o),1!=t&&(a[0]=r),JSON.stringify(a)},n.toFormdata=function(e,t){var n=JSON.parse(e),a={},r=n[0]||{},o=n[1]||{};for(var i in r)a[i+"_0"]=r[i];for(var c in o)a[c+"_1"]=o[c];return console.log("formdata--",a),a},n.testConfig=function(e){var t=n.props.form.getFieldsValue,a=Object.assign({},t()),r=a.name,o=a.remark,i=a.type;if(r)if(o){for(var c in a)if(c.indexOf("_"+e)>-1&&!a[c]&&n.configIsRequired(i,c.slice(0,-2)))return void Object(X.a)({type:"warn",description:"请将".concat(1==e?"测试":"生产","环境配置完整")});Object(l.d)(l.a.testDataAssets,{name:r,remark:o,type:i,dataJson:n.getJsonStr(a,e)}).then(function(e){Object(X.a)({type:"success",description:"通过"})})}else Object(X.a)({type:"warn",description:"数据资源描述不能为空"});else Object(X.a)({type:"warn",description:"数据资源名称不能为空"})},n.ref1=Object(o.createRef)(),n.param={1:{userName:"用户名",pwd:"密码",topic:"队列名"},2:{addr:"数据源地址",port:"端口号",database:"数据库名",userName:"用户名",pwd:"密码"},3:{addr:"url",type:"POST"},4:{addr:"数据源地址",port:"端口号",database:"数据库",pwd:"密码"},5:{topic:"队列名",tags:"tags_多个标签请用竖线隔开，例如“a|b|c”"}},n.state={typeList:[{id:1,name:"mqtt"},{id:2,name:"mysql数据库"},{id:4,name:"redis"},{id:5,name:"rocketMq"}],assetType:1,projectList:[]},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ha(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;Object(l.c)(l.a.getProjectList).then(function(t){t&&t.data&&e.setState({projectList:t.data})}),t>0&&Object(l.c)(l.a.getInfoDataAssets,{id:t},{loading:!0}).then(function(t){var n=t.data,a=n.dataJson,r=n.name,o=n.remark,i=n.type,c=n.projectId,s=e.toFormdata(a,i),l={assetType:i};3==i&&(l.param1=s.param_1,delete s.param0,delete s.param1),e.setState(l,function(){e.props.form.setFieldsValue(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ba(n,!0).forEach(function(t){qa(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ba(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:i,name:r,remark:o},s,{projectId:c&&c.split(",").map(function(e){return+e})||[]}))})})}},{key:"render",value:function(){var e=this,t=this.state,n=t.assetType,a=t.projectList,r=(t.param0,t.param1),o=this.getTypeList(),c=this.props.form,s=c.getFieldDecorator,l=c.getFieldValue,u=this.props.match.params,d=u.id,y=u.readOnly,g=y?"详情":0==d?"创建数据资产源":"修改数据资产源",v=1==y;return i.a.createElement("div",{className:"asset-detail-page"},i.a.createElement(p.a,{backHandle:function(){return e.props.history.goBack()},title:"数据资产源"}),i.a.createElement("div",{className:"commonContentBox"},i.a.createElement("div",{className:"title"},g),i.a.createElement("div",{className:"centent",style:{position:"relative"}},i.a.createElement(m.a,Ua({},{labelCol:{span:2},wrapperCol:{span:12}},{onSubmit:this.handleSubmit}),i.a.createElement(m.a.Item,{label:"类型"},s("type",{rules:[{required:!0,message:"请选择数据资产源类型"}],initialValue:1})(i.a.createElement(b.a,{placeholder:"选择类型",onChange:this.changeType},o.map(function(e){return i.a.createElement(b.a.Option,{key:e.id,value:e.id},e.name)})))),i.a.createElement(m.a.Item,{label:"所属项目"},s("projectId",{})(i.a.createElement(b.a,{placeholder:"选择所属项目",allowClear:!0,mode:"multiple",disabled:v},a.map(function(e,t){return i.a.createElement(b.a.Option,{key:t,value:e.projectId},e.name)})))),i.a.createElement(m.a.Item,{label:"名称"},s("name",{rules:[{required:!0,message:"请输入数据源名称"},{max:20,message:"最大输入长度为30"}]})(i.a.createElement(h.a,{placeholder:"数据源名称"}))),i.a.createElement(We.a,{ref:"pramsRef2",label:"描述",formId:"remark",astrictNub:"200",rows:"3",isRequired:!0,placeholder:"数据资产源描述",getFieldDecorator:s,getFieldValue:l}),i.a.createElement(Ve.a,{gutter:24},i.a.createElement(Ke.a,{span:12},i.a.createElement(J.a,{title:"测试环境配置：",className:"titleenvironment",bordered:!1},n&&this.getFormParDom(1))),i.a.createElement(Ke.a,{span:12},i.a.createElement(J.a,{title:"生产环境配置：",className:"titleenvironment",bordered:!1},n&&this.getFormParDom(0)))),3==n&&i.a.createElement(Ra,{ref:this.ref1,list:r}),i.a.createElement(Ve.a,{gutter:48},i.a.createElement(Ke.a,{span:12},!v&&i.a.createElement("a",{className:"testbtn",onClick:this.testConfig.bind(this,1)},"测试")),i.a.createElement(Ke.a,{span:12},!v&&i.a.createElement("a",{className:"testbtn",onClick:this.testConfig.bind(this,0)},"测试"))),!v&&i.a.createElement("div",{className:"btnbox"},i.a.createElement(f.a,{className:"btn",onClick:function(){return e.props.history.goBack()}},"取消"),i.a.createElement(f.a,{type:"primary",htmlType:"submit",className:"btn"},"保存"))),v&&i.a.createElement("div",{className:"mask"}))))}}])&&Wa(n.prototype,a),r&&Wa(n,r),t}(),Ya=m.a.create({name:"dataassetdetail"})(Za),Qa=n("MUf8"),$a=n("k+EZ"),Xa=n("UpsA"),er=n("d8kt");n("J2fM");function tr(e){return(tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nr(){return(nr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function ar(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function rr(e,t){return!t||"object"!==tr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function or(e){return(or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ir(e,t){return(ir=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"default",function(){return cr});var cr=Object(s.b)(function(e){return{developerInfo:e.getIn(["userCenter","developerInfo"]).toJS(),newMessageNums:e.getIn(["message","newMessageNums"]).toJS()}},function(e){return{getNewMessageNums:function(){return e(Object(er.a)())},getDeveloperInfo:function(){return e(Object(u.d)())}}})(za=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),rr(this,or(t).apply(this,arguments))}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ir(e,t)}(t,o["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){var e=this.props,t=e.newMessageNums,n=e.getNewMessageNums,a=e.getDeveloperInfo,o=e.developerInfo;r()(t)&&n(),r()(o)&&a()}},{key:"render",value:function(){var e=this.props,t=e.developerInfo,n=e.newMessageNums,a=e.match,r=e.getDeveloperInfo,o=a.path,s=!(1===t.isSubUser);return i.a.createElement(Qa.a,null,i.a.createElement("div",{className:"page-header-wrapper"},i.a.createElement($a.a,{newMessageNums:n,developerInfo:t,noCollapsed:!0})),i.a.createElement("div",{className:"content-wrapper"},i.a.createElement(Xa.a,{developerInfo:t}),i.a.createElement("section",{className:"right-wrapper flex-column"},i.a.createElement("div",{className:"flex1 scroll-y"},i.a.createElement(c.e,null,i.a.createElement(c.c,{path:"".concat(o,"/info"),component:W}),i.a.createElement(c.c,{path:"".concat(o,"/security"),render:function(e){return i.a.createElement(Nn,nr({},e,{developerInfo:t,getDeveloperInfo:r}))}}),i.a.createElement(Qt.a,{component:oe,path:"".concat(o,"/role"),redirect:"".concat(o,"/info"),isOk:s}),i.a.createElement(Qt.a,{component:it,path:"".concat(o,"/visit"),redirect:"".concat(o,"/info"),isOk:s}),i.a.createElement(Qt.a,{component:Pt,path:"".concat(o,"/look"),redirect:"".concat(o,"/info"),isOk:s}),i.a.createElement(Qt.a,{component:De,path:"".concat(o,"/add"),redirect:"".concat(o,"/info"),isOk:s}),i.a.createElement(Qt.a,{component:Yt,path:"".concat(o,"/log"),redirect:"".concat(o,"/info"),isOk:s}),i.a.createElement(Qt.a,{component:ea,path:"".concat(o,"/case"),redirect:"".concat(o,"/info"),isOk:s}),i.a.createElement(Qt.a,{component:_a,path:"".concat(o,"/authorize"),redirect:"".concat(o,"/info"),isOk:s}),i.a.createElement(Qt.a,{component:Ma,path:"".concat(o,"/dataasset"),redirect:"".concat(o,"/info"),isOk:s}),i.a.createElement(Qt.a,{component:Ya,path:"".concat(o,"/assetdetail/:id/:readOnly"),redirect:"".concat(o,"/info"),isOk:s,developerInfo:t}),i.a.createElement(c.b,{to:"".concat(o,"/info")}))))))}}])&&ar(n.prototype,a),s&&ar(n,s),t}())||za},ccuU:function(e,t,n){},hZG8:function(e,t,n){},ivPg:function(e,t,n){e.exports=n.p+"static/images/no-source-tip.681eb7825cf81b5da33967ff8571f3c6.png"},kmdx:function(e,t,n){},sCcn:function(e,t,n){},wA0d:function(e,t,n){},y1Sk:function(e,t,n){}}]);