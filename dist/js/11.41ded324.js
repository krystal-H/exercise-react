(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"+ch6":function(e,t,a){"use strict";a("pNMO"),a("4Brf"),a("0oug"),a("ma9I"),a("x0AG"),a("pjDv"),a("4mDm"),a("oVuX"),a("2B1R"),a("pDQq"),a("sMBO"),a("07d7"),a("5s+n"),a("p532"),a("JfAA"),a("PKPk"),a("3bBZ"),a("L/Qf");var n=a("2/Rp"),r=(a("1vPl"),a("5rEg")),o=(a("8QGh"),a("2fM7")),c=a("q1tI"),i=a.n(c);function l(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(a.push(c.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var u=o.a.Option,d=["按产品","按分组"];t.a=function(e){var t=e.list,a=e.searchedData,p=e.multiple,m=void 0!==p&&p,f=e.onRef,v=e.inputkey,g=s(Object(c.useState)(0),2),y=g[0],h=g[1],b=s(Object(c.useState)([-1]),2),E=b[0],O=b[1],I=s(Object(c.useState)(""),2),w=I[0],P=I[1],S=s(Object(c.useState)(!1),2),C=S[0],x=S[1],D=s(Object(c.useState)(!1),2),L=D[0],j=D[1];Object(c.useEffect)(function(){f&&f(N)});var k=function(e,t){var a=e.findIndex(function(e){return t==e}),n=l(e);return a>-1&&n.splice(a,1),n},N=function(){var e={type:y};return w&&(e[v]=w),E.length>0&&-1!==E[0]&&(e.productIds=E.join(",")),e};return i.a.createElement("div",{className:"comm-search-box"},i.a.createElement(r.a.Group,{compact:!0,className:"inputgroup"},i.a.createElement(o.a,{value:y,onChange:function(e){h(e),O([-1])}},d.map(function(e,t){return i.a.createElement(u,{key:t,value:t},e)})),i.a.createElement(o.a,{showSearch:!0,optionFilterProp:"children",mode:m?"multiple":"",defaultValue:[-1],value:E,onChange:!m&&function(e){O([e])}||void 0,onSelect:m&&function(e){O(-1==e?[-1]:function(t){var a=k(t,-1);return[].concat(l(a),[e])})}||void 0,onDeselect:m&&function(e){O(function(t){return k(t,e)})}||void 0,style:{width:250}},i.a.createElement(u,{value:-1},"全部".concat(0==y?"产品":"分组")),t[y].map(function(e,t){var a=e.productId,n=e.id,r=e.name,o=e.productName;return i.a.createElement(u,{key:t,value:[a,n][y]},[o,r][y])})),v&&i.a.createElement(r.a,{value:w,maxLength:30,placeholder:"请输入设备ID查询",style:{width:200},onChange:function(e){P(e.target.value)}})),i.a.createElement(n.a,{type:"primary",className:"btn",onClick:function(){x(!0),a(N()).finally(function(e){console.log("---rrr--",e),x(!1)})},loading:C,icon:"search"},"查询"),i.a.createElement(n.a,{type:"default",className:"btn",loading:L,onClick:function(){h(0),O([-1]),P(""),j(!0),a({}).finally(function(){j(!1)})}},"重置"))}},C46E:function(e,t,a){"use strict";a.r(t);a("07d7"),a("5s+n"),a("Rm1S");var n,r=a("q1tI"),o=a.n(r),c=a("Ty5D"),i=a("MKeS"),l=(a("pNMO"),a("4Brf"),a("0oug"),a("ma9I"),a("TeQF"),a("4mDm"),a("5DmW"),a("27RR"),a("NBAS"),a("tkto"),a("ExoC"),a("PKPk"),a("UxlC"),a("SYor"),a("FZtP"),a("3bBZ"),a("YQTV"),a("NUBc")),s=(a("mbEz"),a("wCAj")),u=(a("L/Qf"),a("2/Rp")),d=(a("1vPl"),a("5rEg")),p=(a("TfFZ"),a("3S7+")),m=(a("2oDE"),a("CtXQ")),f=(a("8QGh"),a("2fM7")),v=a("/MKj"),g=a("55Ip"),y=a("Nlzp"),h=a("Per8"),b=a("cu44"),E=a("MeRu"),O=a("+ch6"),I=a("P2RN");function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function S(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(a,!0).forEach(function(t){C(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function C(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function x(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function D(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var k=f.a.Option,N={1:void 0,2:!0,3:!1},R=Object(v.b)(function(e){return{productList:e.getIn(["device","productList"]).toJS(),deviceStat:e.getIn(["device","deviceStat"]).toJS(),deviceList:e.getIn(["device","deviceList"]).toJS(),freshStatu:e.getIn(["device","freshStatu"])}},function(e){return{getProductList:function(t){return e(Object(h.f)(t))},getDeviceStat:function(t){return e(Object(h.d)(t))},getDeviceList:function(t){return e(Object(h.c)(t))}}})(n=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=D(this,L(t).call(this,e))).getProductList=function(){a.props.getProductList({pageIndex:1,pageRows:9999})},a.getGroupList=function(){Object(y.c)(y.a.getGroupList,{pageIndex:1,pageRows:9999}).then(function(e){a.setState({groupList:e.data&&e.data.list||[]})})},a.getCountDataParams=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"classType",t=a.state.countDataParams,n=t.classType,r=t.productId,o=t.subgroupId,c=C({},e,n);return 1==n?c.productId=r:2==n&&(c.subgroupId=o),c},a.getListParams=function(){var e=S({},a.state.listParams),t=e.innet,n=e.online;return e.innet=N[t],e.online=N[n],e},a.getDeviceStat=function(){return a.props.getDeviceStat(a.getCountDataParams("type"))},a.getDeviceList=function(){var e=a.getCountDataParams("classType"),t=a.getListParams();return a.props.getDeviceList(S({},e,{},t))},a.onChangeListParams=function(e,t){console.log(e,t);var n=S({},a.state.listParams);n[e]=t.trim&&t.trim()||t||void 0,a.setState({listParams:n})},a.inquireDeviceList=function(){var e=S({},a.state.listParams);e.pageIndex=1,a.setState({listParams:e},a.getDeviceList)},a.searchedData=function(e){var t=e.type,n=void 0===t?0:t,r=e.productIds;return console.log(99,e),a.setState({countDataParams:{classType:++n,productId:r,subgroupId:r}},function(){a.getDeviceList(),a.getDeviceStat()}),Promise.resolve(1)},a.changePage=function(e){var t=S({},a.state.listParams);t.pageIndex=e,a.setState({listParams:t},a.getDeviceList)},a.resetSearch=function(){a.setState({listParams:{pageIndex:1,pageRows:10,infoType:1,field:void 0,labelKey:void 0,labelValue:void 0,innet:1,online:1}},a.getDeviceList)},a.exportData=function(){var e=S({superInstanceId:localStorage.getItem("superInstanceId")},a.getCountDataParams(),{},a.getListParams()),t="?";for(var n in e)void 0!==e[n]&&(t+="".concat(n,"=").concat(e[n],"&"));var r=window.location.origin+y.a.exportDeviceList+t.replace(/&$/,"");try{window.open(r)}catch(e){Object(I.a)({description:e,type:"error"})}},a.state={groupList:[],countDataParams:{classType:1,productId:void 0,subgroupId:void 0},listParams:{pageIndex:1,pageRows:10,infoType:1,field:void 0,labelKey:void 0,labelValue:void 0,innet:1,online:1}},a}var a,n,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,r["PureComponent"]),a=t,(n=[{key:"componentDidMount",value:function(){this.getProductList(),this.getGroupList(),this.getDeviceStat(),this.getDeviceList()}},{key:"render",value:function(){var e=this,t=this.state,a=t.listParams,n=t.groupList,r=this.props,c=r.productList,i=r.deviceStat,v=r.deviceList,y=r.freshStatu,h=v.pager,I=void 0===h?{}:h,w=v.list,P=void 0===w?[]:w,S=[{title:"设备ID",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"物理地址",dataIndex:"deviceMac",key:"deviceMac"},{title:"产品",dataIndex:"productName",key:"productName"},{title:"分类",dataIndex:"productType",key:"productType"},{title:"所属分组",dataIndex:"groupName",key:"groupName"},{title:"类型",dataIndex:"productClass",key:"productClass",render:function(e){return{0:"普通设备",1:"网关设备"}[e]||"--"}},{title:"操作",key:"opt_detail",render:function(e,t){return o.a.createElement("span",null,o.a.createElement(g.b,{key:"detail",to:"/open/base/device/onlineDevice/details/"+t.deviceId},"查看"))}}],C=i.exception,x=i.total,D=i.totalActive,L=i.todayActive,j=a.pageIndex,N=a.pageRows,R=a.infoType,T=a.field,_=a.labelKey,A=a.labelValue,K=a.innet,V=a.online;return o.a.createElement("section",{className:"page-main-wrapper flex-column devicelistpage"},o.a.createElement(E.a,{noback:!0,title:"设备管理"}),o.a.createElement("header",{className:"page-content-header"},o.a.createElement(O.a,{list:[c,n],searchedData:this.searchedData}),o.a.createElement("div",{className:"count-data-box"},o.a.createElement("ul",{className:"device-inine-data"},o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"当前异常数"),o.a.createElement("span",{className:"count"},C||0)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"累计设备总数"),o.a.createElement("span",{className:"count"},x||0)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"累计入网总数"),o.a.createElement("span",{className:"count"},D||0)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"今日入网总数"),o.a.createElement("span",{className:"count"},L||0))),o.a.createElement("div",{className:"device-refresh",onClick:this.getDeviceStat},o.a.createElement("span",null,"刷新"),o.a.createElement(m.a,{type:"sync",className:"device-refresh-icon",spin:!y})))),o.a.createElement("div",{className:"flex-column flex1"},o.a.createElement(b.a,{title:"联网设备列表"},o.a.createElement("div",{className:"alone-section-content-default"},o.a.createElement(p.a,{title:"最多导出1千条数据",placement:"top"},o.a.createElement("a",{href:"javascript:void(0)",className:"btn-exportdata",onClick:this.exportData},"导出数据")),o.a.createElement("div",{className:"lineSearchBox"},o.a.createElement("div",{className:"search-info-box"},o.a.createElement("div",{className:"searchBox"},o.a.createElement(d.a.Group,{compact:!0},o.a.createElement(f.a,{className:"type-select",value:R,onChange:function(t){e.onChangeListParams("infoType",t)}},o.a.createElement(k,{value:1},"设备ID"),o.a.createElement(k,{value:2},"物理地址")),o.a.createElement(d.a,{className:"input",maxLength:100,value:T,placeholder:"请输入设备ID号",onChange:function(t){e.onChangeListParams("field",t.target.value)}}))),o.a.createElement("span",{className:"margin-left-10px"},"设备标签："),o.a.createElement(d.a,{className:"input",placeholder:"请输入标签Key",maxLength:100,value:_,onChange:function(t){e.onChangeListParams("labelKey",t.target.value)}}),o.a.createElement(d.a,{className:"input margin-left-10px",placeholder:"请输入标签Value",maxLength:100,value:A,onChange:function(t){e.onChangeListParams("labelValue",t.target.value)}}),o.a.createElement(f.a,{className:"type-select margin-left-10px",value:K,onChange:function(t){e.onChangeListParams("innet",t)}},o.a.createElement(k,{value:1},"已/未入网"),o.a.createElement(k,{value:2},"已入网"),o.a.createElement(k,{value:3},"未入网")),o.a.createElement(f.a,{className:"type-select margin-left-10px",value:V,onChange:function(t){e.onChangeListParams("online",t)}},o.a.createElement(k,{value:1},"在/离线"),o.a.createElement(k,{value:2},"在线"),o.a.createElement(k,{value:3},"离线"))),o.a.createElement("div",{className:"searchBut"},o.a.createElement(u.a,{className:"btn",type:"primary",onClick:this.inquireDeviceList},"查询"),o.a.createElement(u.a,{className:"btn",onClick:this.resetSearch},"重置"))),o.a.createElement(s.a,{className:"devicetablelist",rowKey:"deviceUniqueId",dataSource:P,columns:S,pagination:!1})),o.a.createElement("div",{className:"list-pagination"},I&&I.totalRows>0&&o.a.createElement(l.a,{className:"self-pa",total:I.totalRows,current:j,defaultCurrent:1,defaultPageSize:N,onChange:function(t){return e.changePage(t)},showTotal:function(e){return o.a.createElement("span",null,"共 ",o.a.createElement("a",null,e)," 条")},showQuickJumper:!0,hideOnSinglePage:!0})))))}}])&&x(a.prototype,n),c&&x(a,c),t}())||n,T=(a("sMBO"),a("k3Gp"),a("kLXV")),_=(a("qNb/"),a("PArb")),A=a("FC04"),K=(a("tULf"),a("Vl3Y")),V=a("M7r8");function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function F(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var B=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=F(this,q(t).call(this,e))).state={},a}var a,n,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(t,r["Component"]),a=t,(n=[{key:"componentDidMount",value:function(){this.props.onRef(this)}},{key:"render",value:function(){var e=this.props.form,t=e.getFieldDecorator,a=e.getFieldValue;return o.a.createElement(K.a,{labelCol:{span:4},wrapperCol:{span:20}},o.a.createElement(K.a.Item,{label:"分组名称"},t("name",{rules:[{required:!0,message:"请输入分组名称"},{max:50,message:"最大输入长度为50"}]})(o.a.createElement(d.a,{placeholder:"请输入分组名称"}))),o.a.createElement(V.a,{label:"分组描述",formId:"remark",astrictNub:"50",rows:"4",placeholder:"分组描述",getFieldDecorator:t,getFieldValue:a}))}}])&&G(a.prototype,n),c&&G(a,c),t}(),Y=K.a.create({name:"caseAdd"})(B),Q=(a("ECLI"),a("wd/R")),H=a.n(Q);function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=Z(t).call(this,e),(a=!r||"object"!==W(r)&&"function"!=typeof r?z(n):r).getList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(y.c)(y.a.getGroupList,e).then(function(e){a.setState({caseList:e.data.list,pager:e.data.pager,loading:!1})})},a.addCase=function(){a.setState({addCaseVisible:!0})},a.openDel=function(e,t){a.setState({id:e,name:t})},a.delOkCancel=function(e){if("ok"==e){var t=a.state,n=t.id,r=t.pageIndex;r=r||1,Object(y.c)(y.a.deleteGroup,{id:n}).then(function(e){0==e.code&&a.setState({loading:!0,id:""},function(){a.getList({pageIndex:r,pageRows:10})})})}else a.setState({id:""})},a.searchCase=function(e){a.setState({loading:!0,searchName:e},function(){a.pagerIndex(1)})},a.updateModal=function(e){1==e?(0,a.addFormRefs.props.form.validateFieldsAndScroll)(function(e,t){var n=t.name,r=t.remark;e||Object(y.d)(y.a.updateGroup,{name:n,remark:r}).then(function(e){0==e.code&&(Object(I.a)({type:"success",description:"新增成功！"}),a.addCancel(),a.pagerIndex(1))})}):a.addCancel()},a.addCancel=function(){a.setState({addCaseVisible:!1}),a.addFormRefs.props.form.resetFields()},a.pagerIndex=function(e){a.setState({pageIndex:e,loading:!0},function(){a.getList({pageIndex:e,pageRows:10,name:a.state.searchName||void 0})})},a.state={loading:!0,caseList:[],pager:{},searchName:"",name:"",id:"",addCaseVisible:!1,pageIndex:"1"},a.columns=[{title:"分组名称",dataIndex:"name",key:"name"},{title:"分组ID",dataIndex:"id",key:"id"},{title:"描述",dataIndex:"remark",key:"remark"},{title:"添加时间",dataIndex:"createTime",key:"createTime",render:function(e){return o.a.createElement("span",null,e&&H()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"操作",key:"action",width:"140px",render:function(e,t){return o.a.createElement("span",null,o.a.createElement(g.b,{to:"/open/base/device/groupDetails/".concat(t.id,"/").concat(t.groupId)},"查看"),o.a.createElement(_.a,{type:"vertical"}),o.a.createElement("a",{onClick:a.openDel.bind(z(a),t.id,t.name)},"删除"))}}],a}var a,n,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(t,r["Component"]),a=t,(n=[{key:"componentDidMount",value:function(){this.getList({pageIndex:1,pageRows:10})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.addCaseVisible,r=t.caseList,c=t.pager,i=t.id,l=t.name;return o.a.createElement("div",{className:"devicegroup-box"},o.a.createElement("header",{className:"page-content-header"},o.a.createElement(E.a,{noback:!0,title:"设备分组管理"}),o.a.createElement("div",null,o.a.createElement("div",{className:"searchBox"},o.a.createElement(d.a.Search,{placeholder:"请输入分组名查找",enterButton:!0,maxLength:20,onSearch:function(t){return e.searchCase(t)}})),o.a.createElement("div",{className:"butFloatRight"},o.a.createElement(u.a,{className:"but-add",type:"primary",onClick:this.addCase},"新增分组")))),o.a.createElement("div",{className:"commonContentBox"},o.a.createElement("div",{className:"centent"},o.a.createElement(s.a,{rowKey:"id",columns:this.columns,dataSource:r,pagination:{defaultCurrent:c.pageIndex,total:c.totalRows,hideOnSinglePage:!1,onChange:this.pagerIndex,current:c.pageIndex},loading:a}))),o.a.createElement(T.a,{title:"新增分组",visible:n,width:600,onOk:this.updateModal.bind(this,1),onCancel:this.updateModal.bind(this,2),maskClosable:!1,className:"self-modal"},o.a.createElement(Y,{onRef:function(t){return e.addFormRefs=t}})),o.a.createElement(A.a,{visible:!!i,modalOKHandle:this.delOkCancel.bind(this,"ok"),modalCancelHandle:this.delOkCancel.bind(this,"cancel"),title:"删除分组",descText:"即将删除分组",targetName:l}))}}])&&J(a.prototype,n),c&&J(a,c),t}(),ee=(a("oVuX"),a("OrB1"),a("gFTJ")),te=a("BkRI"),ae=a.n(te),ne=(a("2B1R"),a("p532"),a("7W5+"),a("8z0m")),re=(a("K4yd"),a("9yH6"));a("x0AG"),a("pjDv"),a("pDQq"),a("JfAA");function oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,r=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(a.push(c.value),!t||a.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ce=function(e){var t=e.productList,a=e.changedfunc,n=e.searchedFunc,c=oe(Object(r.useState)([-1]),2);c[0],c[1];return o.a.createElement("div",{className:"search-box"},o.a.createElement(d.a.Group,{compact:!0},o.a.createElement(f.a,{showSearch:!0,optionFilterProp:"children",defaultValue:[-1],onChange:a,style:{width:200}},o.a.createElement(f.a.Option,{value:-1},"全部产品"),t.map(function(e,t){return o.a.createElement(f.a.Option,{key:t,value:e.productId},e.productName)})),o.a.createElement(d.a.Search,{enterButton:!0,maxLength:30,placeholder:"请输入设备ID查询",onSearch:n,style:{width:300}})))};function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function se(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?le(a,!0).forEach(function(t){ue(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):le(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function ue(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function de(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pe(e,t){return!t||"object"!==ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fe(e,t){return(fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ve=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=pe(this,me(t).call(this,e))).getCreateProduct=function(){Object(y.c)(y.a.getCreateProduct,{pageRows:999}).then(function(e){var t=e.data.list;t&&t.length&&t.length>0&&a.setState({addProductList:t})})},a.getGroupAddDevList=function(){a.setState({listLoading:!0});var e=se({},a.state.addListParams);-1==e.productId&&delete e.productId,Object(y.c)(y.a.getGroupSlctDev,e).then(function(e){var t=e.data||{},n=t.list,r=t.pager;0==e.code&&a.setState({list:n,pager:r})}).finally(function(){a.setState({listLoading:!1})})},a.setQuestParams=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=se({},a.state.addListParams);r[e]=t||void 0,"pageIndex"!==e&&(r.pageIndex=1),a.setState({addListParams:r},!n&&a.getGroupAddDevList||void 0)},a.onSelectRowKeys=function(e){a.setState({selectedRowKeys:e})},a.addDeviceOk=function(){var e=a.state,t=e.addWay,n=e.selectedRowKeys;if(1==t){var r=n;r.length>0&&Object(y.d)(y.a.addGroupDevice,{id:a.props.id,deviceIds:r.join(",")}).then(function(e){a.setState({selectedRowKeys:[]}),a.props.openCloseAdd(!0)})}else 2==t&&a.publicTypeForm()},a.addUPload=function(e){e.groupId=a.props.groupid,e.type=1,Object(y.d)(y.a.addDevice,e).then(function(e){a.props.openCloseAdd(!0)})},a.changeAddWay=function(e){var t=e.target.value;a.setState({addWay:t})},a.state={addWay:1,listLoading:!1,list:[],pager:{},selectedRowKeys:[],addListParams:{pageIndex:1,pageRows:8,id:e.id,productId:-1,deviceUniqueId:void 0},addProductList:[]},a.columns=[{title:"设备id",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"所属产品",dataIndex:"productName",key:"productName"},{title:"状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement("span",null,{0:"有效",1:"未激活",2:"在线",3:"离线",4:"禁用"}[e])}},{title:"最后上线时间",dataIndex:"lastOnlineTime",key:"lastOnlineTime",render:function(e){return o.a.createElement("span",null,e&&H()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}}],a}var a,n,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fe(e,t)}(t,r["PureComponent"]),a=t,(n=[{key:"componentDidMount",value:function(){this.props.onRef(this),this.getCreateProduct()}},{key:"render",value:function(){var e=this,t=this.props,a=t.addVisiable,n=t.openCloseAdd,r=this.state,c=r.selectedRowKeys,i=r.list,l=r.pager,u=r.addWay,d=r.listLoading,p=r.addProductList,m={selectedRowKeys:c,onChange:this.onSelectRowKeys};return o.a.createElement(T.a,{title:"添加设备到分组",visible:a,width:750,onOk:this.addDeviceOk,onCancel:function(){n(!1)},maskClosable:!1,closable:!1,className:"groupadd-device-modal"},o.a.createElement("div",{className:"addtype"},o.a.createElement(re.a.Group,{value:u,onChange:this.changeAddWay},o.a.createElement(re.a,{value:1},"查找选择"),o.a.createElement(re.a,{value:2},"本地导入"))),1==u?o.a.createElement("div",{className:""},o.a.createElement(ce,{productList:p,changedfunc:function(t){e.setQuestParams("productId",t,!0)},searchedFunc:function(t){e.setQuestParams("deviceUniqueId",t)}}),o.a.createElement("div",{className:"list-content"},o.a.createElement(s.a,{rowKey:"deviceId",columns:this.columns,dataSource:i,rowSelection:m,loading:!!d,pagination:{defaultCurrent:l.pageIndex,total:l.totalRows,onChange:function(t){e.setQuestParams("pageIndex",t)},current:l.pageIndex}}))):o.a.createElement(ge,{productList:p,onRef:function(t){return e.publicTypeForm=t},addUPload:this.addUPload}))}}])&&de(a.prototype,n),c&&de(a,c),t}(),ge=K.a.create({name:"form-upload-device"})(function(e){var t=e.form,a=e.productList,n=e.onRef,c=e.addUPload;Object(r.useEffect)(function(){n(s)},[]);var i=t.getFieldDecorator,l=t.validateFields,s=function(){l(function(e,t){if(console.log(3333,t),!e){var a=t.data,n=t.productId,r="";if(a&&a.fileList&&a.fileList.length){var o=a.fileList[0];o&&o.response&&o.response.data&&(r=o.response.data.url)}c({productId:n,data:r})}})};return o.a.createElement("div",null,o.a.createElement(K.a,{labelCol:{span:6},wrapperCol:{span:10}},o.a.createElement(K.a.Item,{label:"产品"},i("productId",{rules:[{required:!0,message:"请选择产品！"}],initialValue:""})(o.a.createElement(f.a,{showSearch:!0,optionFilterProp:"children",placeholder:"请选择产品"},o.a.createElement(f.a.Option,{value:"",disabled:!0,selected:!0},"请选择产品"),a.map(function(e){var t=e.productName,a=e.productId;return o.a.createElement(f.a.Option,{key:a,value:a},t)})))),o.a.createElement(K.a.Item,{label:"上传文件"},i("data",{rules:[{required:!0,message:"请上传文件！"}]})(o.a.createElement(ne.a,{accept:".xls,.xlsx",action:y.a.upFileUrl,data:{appId:31438,domainType:4}},o.a.createElement(u.a,{type:"primary",icon:"upload"},"上传文件"),o.a.createElement("span",{style:{marginLeft:"15px"}},"仅支持.xls,.xlsx格式文件"))),o.a.createElement("a",{href:"http://skintest.hetyj.com/31438/6b0b20891e06ac31d0eed37a5083cca9.xlsx"},"下载模板"))))});function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function he(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ee(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ie=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=be(t).call(this,e),(a=!r||"object"!==ye(r)&&"function"!=typeof r?Ee(n):r).openDel=function(e,t){a.setState({delVisable:!0}),e&&(console.log(e),a.setState({delid:e,deldeviceUniqueId:t}))},a.getDetail=function(){Object(y.c)(y.a.getGroupDetail,{id:a.id}).then(function(e){var t=e.data,n=t.name,r=t.createTime,o=t.remark,c=t.deviceCount,i=t.activeCount,l=t.groupId;a.setState({name:n,remark:o,deviceCount:c,activeCount:i,groupId:l,createTime:H()(r).add(8,"h").format("YYYY-MM-DD HH:mm:ss")})})},a.getDownProduct=function(){Object(y.c)(y.a.getDownProduct,{pageRows:999}).then(function(e){var t=e.data.list;t&&t.length&&t.length>0&&a.setState({productList:t})})},a.getGroupDevList=function(){var e=ae()(a.state.listParams);-1==e.productId&&delete e.productId,Object(y.c)(y.a.getGroupDeviceList,e).then(function(e){var t=e.data||{},n=t.list,r=t.pager;a.setState({groupDevList:n,pager:r})})},a.setParams=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=ae()(a.state.listParams);r[e]=t||void 0,"pageIndex"!==e&&(r.pageIndex=1),a.setState({listParams:r},!n&&a.getGroupDevList||void 0)},a.openCloseAdd=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!a.state.addVisiable;a.setState({addVisiable:t}),t?(a.addListRefs.setQuestParams("pageIndex",1),a.addListRefs.setState({addWay:1})):e&&a.getGroupDevList()},a.onSelectRowKeys=function(e){a.setState({selectedRowKeys:e})},a.delOkCancel=function(e){var t=a.state,n=t.delid,r=t.selectedRowKeys;"ok"==e?Object(y.d)(y.a.delGroupDevice,{id:a.id,deviceIds:n||r.join(",")}).then(function(e){0==e.code&&(a.getGroupDevList(),a.setState({delid:"",delVisable:!1,selectedRowKeys:[]}))}):a.setState({delid:"",delVisable:!1})},a.id=e.match.params.groupid,a.groupidid=e.match.params.groupidid,a.defaultListParams={pageIndex:1,pageRows:10,id:a.id,productId:-1,deviceUniqueId:void 0},a.addListRefs=null,a.state={listParams:ae()(a.defaultListParams),name:"--",groupId:"--",createTime:"--",remark:"--",deviceCount:"--",activeCount:"--",groupDevList:[],pager:{},productList:[],addVisiable:!1,addProductList:[],selectedRowKeys:[],delid:"",deldeviceUniqueId:"",delVisable:!1},a.columns=[{title:"设备id",dataIndex:"deviceUniqueId",key:"deviceUniqueId"},{title:"所属产品",dataIndex:"productName",key:"productName"},{title:"设备类型",dataIndex:"productClass",key:"productClass",render:function(e){return o.a.createElement("span",null,0==e?"普通设备":"网关设备")}},{title:"状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement("span",null,{0:"有效",1:"未激活",2:"在线",3:"离线",4:"禁用"}[e])}},{title:"最后上线时间",dataIndex:"lastOnlineTime",key:"lastOnlineTime",render:function(e){return o.a.createElement("span",null,e&&H()(e).add(8,"h").format("YYYY-MM-DD HH:mm:ss")||"--")}},{title:"操作",key:"action",width:"200px",render:function(e,t){return o.a.createElement("span",null,o.a.createElement(g.b,{key:"detail",to:"/open/base/device/onlineDevice/details/"+t.deviceId},"查看"),o.a.createElement(_.a,{type:"vertical"}),o.a.createElement("a",{onClick:a.openDel.bind(Ee(a),t.deviceId,t.deviceUniqueId)},"从分组中删除"))}}],a}var a,n,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oe(e,t)}(t,r["PureComponent"]),a=t,(n=[{key:"componentDidMount",value:function(){this.getDetail(),this.getDownProduct(),this.getGroupDevList()}},{key:"render",value:function(){var e=this,t=this.state,a=t.name,n=t.createTime,r=t.remark,c=t.deviceCount,i=t.activeCount,l=t.groupId,d=t.productList,p=t.groupDevList,m=t.addVisiable,f=t.selectedRowKeys,v=t.pager,g=t.delVisable,y=t.delid,h=t.deldeviceUniqueId,O=t.addProductList,I={selectedRowKeys:f,onChange:this.onSelectRowKeys};return o.a.createElement("section",{className:"page-main-wrapper groupdetailpage flex-column"},o.a.createElement(E.a,{title:"设备分组详情"}),o.a.createElement("header",{className:"page-content-header"},o.a.createElement(ee.a,{title:"",className:"descriptions",column:2},o.a.createElement(ee.a.Item,{label:"分组名称"},a),o.a.createElement(ee.a.Item,{label:"分组ID"},l),o.a.createElement(ee.a.Item,{label:"创建时间"},n),o.a.createElement(ee.a.Item,{label:"描述"},r)),o.a.createElement("ul",{className:"device-inine-data"},o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"设备总数"),o.a.createElement("span",{className:"count"},c)),o.a.createElement("li",null,o.a.createElement("p",null,o.a.createElement("span",{className:"icon-cube"}),"激活设备数"),o.a.createElement("span",{className:"count"},i)))),o.a.createElement(b.a,{title:"设备列表"},o.a.createElement("div",{className:"alone-section-content-default"},o.a.createElement(ce,{productList:d,changedfunc:function(t){e.setParams("productId",t,!0)},searchedFunc:function(t){e.setParams("deviceUniqueId",t)}}),o.a.createElement("div",{className:"search-box"},o.a.createElement(u.a,{className:"but-add",type:"primary",onClick:this.openCloseAdd},"添加设备到分组")),o.a.createElement("div",null,o.a.createElement(u.a,{disabled:0==f.length,className:"but-del",type:"primary",onClick:this.openDel.bind(this,0)},"删除"),o.a.createElement(s.a,{rowKey:"deviceId",columns:this.columns,dataSource:p,rowSelection:I,pagination:{defaultCurrent:v.pageIndex,total:v.totalRows,hideOnSinglePage:!1,onChange:function(t){e.setParams("pageIndex",t)},current:v.pageIndex}})))),o.a.createElement(ve,{addVisiable:m,onRef:function(t){e.addListRefs=t},productList:O,id:this.id,groupid:this.groupidid,openCloseAdd:this.openCloseAdd}),o.a.createElement(A.a,{visible:g,modalOKHandle:this.delOkCancel.bind(this,"ok"),modalCancelHandle:this.delOkCancel.bind(this,"cancel"),title:"从分组中删除",descText:"即将删除".concat(y?"设备":"选中的"),targetName:y?"".concat(h):"".concat(f.length,"个设备")}))}}])&&he(a.prototype,n),c&&he(a,c),t}();a("Zy8g");a.d(t,"default",function(){return xe});var we=Object(i.a)(function(){return Promise.all([a.e("common"),a.e("antd-vendor"),a.e("vendor"),a.e(2),a.e(13)]).then(a.bind(null,"kZcz"))}),Pe=Object(i.a)(function(){return a.e(14).then(a.bind(null,"R4Qp"))}),Se=Object(i.a)(function(){return Promise.all([a.e("common"),a.e("antd-vendor"),a.e(16)]).then(a.bind(null,"vT3+"))}),Ce=Object(i.a)(function(){return Promise.all([a.e("common"),a.e("antd-vendor"),a.e(15)]).then(a.bind(null,"lunQ"))});function xe(e){var t=e.match.path;return o.a.createElement(c.e,null,o.a.createElement(c.c,{path:"".concat(t,"/onlineDevice/list"),component:R}),o.a.createElement(c.c,{path:"".concat(t,"/onlineDevice/details/:deviceid"),component:we}),o.a.createElement(c.c,{path:"".concat(t,"/deviceSecret"),component:Pe}),o.a.createElement(c.c,{path:"".concat(t,"/groups"),component:$}),o.a.createElement(c.c,{path:"".concat(t,"/groupDetails/:groupid/:groupidid"),component:Ie}),o.a.createElement(c.c,{path:"".concat(t,"/deviceWarning"),component:Se}),o.a.createElement(c.c,{path:"".concat(t,"/addWarningConfig"),component:Ce}),o.a.createElement(c.c,{path:"".concat(t,"/warningConfig/:id"),component:Ce}),o.a.createElement(c.b,{to:"".concat(t,"/onlineDevice/list")}))}},ECLI:function(e,t,a){},Zy8g:function(e,t,a){}}]);