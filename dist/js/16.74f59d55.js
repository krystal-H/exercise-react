(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"vT3+":function(e,a,t){"use strict";t.r(a);t("pNMO"),t("4Brf"),t("0oug"),t("TeQF"),t("4mDm"),t("sMBO"),t("5DmW"),t("27RR"),t("tkto"),t("07d7"),t("PKPk"),t("FZtP"),t("3bBZ"),t("L/Qf");var n=t("2/Rp"),r=(t("qNb/"),t("PArb")),l=(t("mbEz"),t("wCAj")),c=(t("AUBz"),t("ZTPi")),i=t("q1tI"),o=t.n(i),d=t("DgvE"),u=t("Nlzp"),s=t("MeRu"),m=t("FC04"),f=(t("k3Gp"),t("kLXV")),g=(t("1vPl"),t("5rEg")),p=(t("Jmwx"),t("BMrR")),E=(t("rO+z"),t("kPKH")),v=t("v7xx"),b=t("P2RN");function y(e,a){return function(e){if(Array.isArray(e))return e}(e)||function(e,a){var t=[],n=!0,r=!1,l=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(t.push(c.value),!a||t.length!==a);n=!0);}catch(e){r=!0,l=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw l}}return t}(e,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var w=function(e){var a=e.warningInof,t=e.closeDetailMod,n=e.delwithWarn,r=a.alarmTime,l=a.warningTitle,c=a.state,s=a.warningWay,m=a.ruleName,w=a.warningDetail,x=a.deviceIds,h=a.dealDetail,O=a.id,I=y(Object(i.useState)(""),2),j=I[0],k=I[1],N=y(Object(i.useState)(""),2),C=N[0],T=N[1],D=1==c&&o.a.createElement(v.a,{style:{padding:"0"},preText:"取消",nextText:"提交",preHandle:t,nextHandle:function(){j?n({id:O,dealDetail:j}):Object(b.a)({description:"请填写处理记录",type:"warn"})}})||o.a.createElement(v.a,{style:{padding:"0"},nextBtn:!1,preText:"关闭",preHandle:t}),W=[12,24];return o.a.createElement(f.a,{className:"warningdetail-page",title:l,visible:!!l,width:700,onCancel:t,footer:D},o.a.createElement(p.a,{gutter:W},o.a.createElement(E.a,{span:5,className:"detail-label"},"告警时间："),o.a.createElement(E.a,{span:18},d.a.utcToDev(r)||"--")),o.a.createElement(p.a,{gutter:W},o.a.createElement(E.a,{span:5,className:"detail-label"},"告警消息类型："),o.a.createElement(E.a,{span:18},{0:"站内",1:"站内+邮件"}[s])),o.a.createElement(p.a,{gutter:W},o.a.createElement(E.a,{span:5,className:"detail-label"},"关联的告警规则："),o.a.createElement(E.a,{span:18},m||"--")),o.a.createElement(p.a,{gutter:W},o.a.createElement(E.a,{span:5,className:"detail-label"},"告警内容："),o.a.createElement(E.a,{span:18},o.a.createElement("div",{className:"border-texarea"},w||"--"))),o.a.createElement(p.a,{gutter:W},o.a.createElement(E.a,{span:5,className:"detail-label"},"告警设备ID："),o.a.createElement(E.a,{span:16},o.a.createElement("div",{className:"border-texarea"},C||x||"")),o.a.createElement(E.a,{span:2},o.a.createElement("a",{href:"javascript:",onClick:function(){Object(u.c)(u.a.getWarningInfo,{warningId:O},{loading:!0}).then(function(e){T(e.data.deviceIds)})}},"刷新"))),o.a.createElement(p.a,{gutter:W},o.a.createElement(E.a,{span:5,className:"detail-label"},"处理记录："),o.a.createElement(E.a,{span:18},1==c&&o.a.createElement(g.a.TextArea,{rows:3,value:j||h||"",placeholder:"处理记录",onChange:function(e){k(e.target.value)}})||o.a.createElement("div",{className:"border-texarea"},j||h||""))))};function x(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function h(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?x(t,!0).forEach(function(a){O(e,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):x(t).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))})}return e}function O(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function I(e,a){return function(e){if(Array.isArray(e))return e}(e)||function(e,a){var t=[],n=!0,r=!1,l=void 0;try{for(var c,i=e[Symbol.iterator]();!(n=(c=i.next()).done)&&(t.push(c.value),!a||t.length!==a);n=!0);}catch(e){r=!0,l=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw l}}return t}(e,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var j=c.a.TabPane,k={pageRows:10,pageIndex:1},N=(a.default=function(e){var a=I(Object(i.useState)({}),2),t=a[0],n=a[1];Object(i.useEffect)(function(){r()},[]);var r=function(){Object(u.c)(u.a.getDeviceWarningTotal,{loading:!0}).then(function(e){var a=e.data;n(a)})};return o.a.createElement("section",{className:"device-secret-wrapper device-warningpage"},o.a.createElement("div",{className:"device-secret-header"},o.a.createElement(s.a,{noback:!0,title:"设备告警"}),o.a.createElement("div",{className:"device-secret-statistic clearfix"},o.a.createElement("div",{className:"common-id"},o.a.createElement("div",null,"待处理告警"),o.a.createElement("div",null,t.pendingCount)),o.a.createElement("div",{className:"used"},o.a.createElement("div",null,"已处理告警"),o.a.createElement("div",null,t.processedCount)),o.a.createElement("div",{className:"register"},o.a.createElement("div",null,"已发送告警"),o.a.createElement("div",null,t.sentCount)),o.a.createElement("div",{className:"unregistered time"},o.a.createElement("div",null,"最近告警时间"),o.a.createElement("div",null,t.leastWaringDate&&d.a.utcToDev(t.leastWaringDate)||"无")))),o.a.createElement(c.a,{defaultActiveKey:e.location.page||"1",tabBarStyle:{background:"#fff",padding:"0 24px",margin:"0"}},o.a.createElement(j,{tab:"告警列表",key:"1"},o.a.createElement("div",{className:"commonContentBox"},o.a.createElement("div",{className:"centent"},o.a.createElement(N,null)))),o.a.createElement(j,{tab:"告警配置",key:"2"},o.a.createElement("div",{className:"commonContentBox"},o.a.createElement("div",{className:"centent"},o.a.createElement(C,{_props:e}))))))},function(e){var a=I(Object(i.useState)({pager:{},list:[]}),2),t=a[0],n=a[1],r=I(Object(i.useState)({}),2),c=r[0],s=r[1];Object(i.useEffect)(function(){m(k)},[]);var m=function(e){Object(u.c)(u.a.getWarningList,e,{loading:!0}).then(function(e){n(e.data)})},f=[{title:"告警时间",dataIndex:"alarmTime",key:"alarmTime",render:function(e){return e?d.a.utcToDev(e):"--"}},{title:"告警标题",dataIndex:"warningTitle",key:"warningTitle"},{title:"告警状态",dataIndex:"state",key:"state",render:function(e){return o.a.createElement("span",null,{1:"待处理",2:"已处理",3:"已发送"}[e])}},{title:"告警消息类型",dataIndex:"warningWay",key:"warningWay",render:function(e){return o.a.createElement("span",null,{0:"站内",1:"站内+邮件"}[e])}},{title:"关联的告警规则",dataIndex:"ruleName",key:"ruleName"},{title:"操作",dataIndex:"id",key:"id",render:function(e,a){var t=a.state;return o.a.createElement("a",{onClick:function(){p(e)},href:"javascript:"},"1"==t?"处理":"查看")}}],g=function(e){m(h({},k,{pageIndex:e}))},p=function(e){Object(u.c)(u.a.getWarningInfo,{warningId:e},{loading:!0}).then(function(e){s(e.data)})},E=function(){s({})},v=t.list,b=t.pager;return o.a.createElement(o.a.Fragment,null,o.a.createElement(l.a,{rowKey:"id",columns:f,dataSource:v,pagination:{defaultCurrent:b.pageIndex,total:b.totalRows,onChange:g,current:b.pageIndex}}),o.a.createElement("p",null,"备注：仅限站内消息类型有“待处理”和“已处理状态”，站内消息+邮件均为“已发送”状态"),o.a.createElement(w,{warningInof:c,closeDetailMod:E,getIndexPage:g,delwithWarn:function(e){Object(u.d)(u.a.dealWithWarning,e,{loading:!0}).then(function(e){g(t.pager.pageIndex||1),E()})}}))}),C=function(e){var a=I(Object(i.useState)({pager:{},list:[]}),2),t=a[0],c=a[1],s=I(Object(i.useState)([]),2),f=s[0],g=s[1];Object(i.useEffect)(function(){p(k)},[]);var p=function(e){Object(u.c)(u.a.getWarningConfigLi,e,{loading:!0}).then(function(e){c(e.data)})},E=[{title:"规则名称",dataIndex:"name",key:"name"},{title:"描述",dataIndex:"remark",key:"remark"},{title:"运行状态",dataIndex:"status",key:"status",render:function(e){return o.a.createElement("span",null,{0:"初始状态",1:"运行中",2:"已停止"}[e])}},{title:"最近编辑时间",dataIndex:"updateTime",key:"updateTime",render:function(e){return e?d.a.utcToDev(e):"--"}},{title:"操作",dataIndex:"id",key:"id",render:function(e,a){var t=a.id,n=a.name,l=a.status;return o.a.createElement("span",null,o.a.createElement("a",{href:"#/open/base/device/warningConfig/".concat(t)},"编辑"),o.a.createElement(r.a,{type:"vertical"}),1==l&&o.a.createElement("a",{onClick:function(){g([t,n,"stop"])},href:"javascript:"},"停止")||o.a.createElement("a",{onClick:function(){b(t)},href:"javascript:"},"启动"),o.a.createElement(r.a,{type:"vertical"}),o.a.createElement("a",{onClick:function(){g([t,n,"del"])},href:"javascript:"},"删除"))}}],v=function(e){p(h({},k,{pageIndex:e}))},b=function(e){Object(u.c)(u.a.startWarningConfigLi,{ruleId:e},{loading:!0}).then(function(e){v(t.pager.pageIndex||1)})},y=t.list,w=t.pager;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"addwarning-btn"},o.a.createElement(n.a,{href:"#/open/base/device/addWarningConfig",icon:"plus",type:"primary"},"新增")),o.a.createElement(l.a,{rowKey:"id",columns:E,dataSource:y,pagination:{defaultCurrent:w.pageIndex,total:w.totalRows,onChange:v,current:w.pageIndex}}),o.a.createElement(m.a,{visible:f.length>0,modalOKHandle:function(){var e="del"==f[2]&&u.a.delWarningConfig||u.a.stopWarningConfig;Object(u.c)(e,{ruleId:f[0]},{loading:!0}).then(function(e){v(t.pager.pageIndex||1),g([])})},modalCancelHandle:function(){g([])},title:"del"==f[2]?"删除":"停止",descText:"即将".concat("del"==f[2]?"删除":"停止","告警配置"),needWarnIcon:!0,targetName:f[1]}))}}}]);